(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))t(i);new MutationObserver(i=>{for(const l of i)if(l.type==="childList")for(const u of l.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&t(u)}).observe(document,{childList:!0,subtree:!0});function e(i){const l={};return i.integrity&&(l.integrity=i.integrity),i.referrerPolicy&&(l.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?l.credentials="include":i.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function t(i){if(i.ep)return;i.ep=!0;const l=e(i);fetch(i.href,l)}})();/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class W{}function E(o,n){const e=/\{([^}]+)\}/g;return o.replace(e,(t,i)=>{if(Object.prototype.hasOwnProperty.call(n,i)){const l=n[i];return l!=null?String(l):""}else throw new Error(`Key '${i}' not found in valueMap.`)})}function r(o,n,e){for(let l=0;l<n.length-1;l++){const u=n[l];if(u.endsWith("[]")){const a=u.slice(0,-2);if(!(a in o))if(Array.isArray(e))o[a]=Array.from({length:e.length},()=>({}));else throw new Error(`Value must be a list given an array path ${u}`);if(Array.isArray(o[a])){const c=o[a];if(Array.isArray(e))for(let f=0;f<c.length;f++){const d=c[f];r(d,n.slice(l+1),e[f])}else for(const f of c)r(f,n.slice(l+1),e)}return}else if(u.endsWith("[0]")){const a=u.slice(0,-3);a in o||(o[a]=[{}]);const c=o[a];r(c[0],n.slice(l+1),e);return}(!o[u]||typeof o[u]!="object")&&(o[u]={}),o=o[u]}const t=n[n.length-1],i=o[t];if(i!==void 0){if(!e||typeof e=="object"&&Object.keys(e).length===0||e===i)return;if(typeof i=="object"&&typeof e=="object"&&i!==null&&e!==null)Object.assign(i,e);else throw new Error(`Cannot set value for an existing key. Key: ${t}`)}else o[t]=e}function s(o,n){try{if(n.length===1&&n[0]==="_self")return o;for(let e=0;e<n.length;e++){if(typeof o!="object"||o===null)return;const t=n[e];if(t.endsWith("[]")){const i=t.slice(0,-2);if(i in o){const l=o[i];return Array.isArray(l)?l.map(u=>s(u,n.slice(e+1))):void 0}else return}else o=o[t]}return o}catch(e){if(e instanceof TypeError)return;throw e}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function M(o,n){if(!n||typeof n!="string")throw new Error("model is required and must be a string");if(o.isVertexAI()){if(n.startsWith("publishers/")||n.startsWith("projects/")||n.startsWith("models/"))return n;if(n.indexOf("/")>=0){const e=n.split("/",2);return`publishers/${e[0]}/models/${e[1]}`}else return`publishers/google/models/${n}`}else return n.startsWith("models/")||n.startsWith("tunedModels/")?n:`models/${n}`}function $e(o,n){const e=M(o,n);return e?e.startsWith("publishers/")&&o.isVertexAI()?`projects/${o.getProject()}/locations/${o.getLocation()}/${e}`:e.startsWith("models/")&&o.isVertexAI()?`projects/${o.getProject()}/locations/${o.getLocation()}/publishers/google/${e}`:e:""}function te(o,n){if(n==null)throw new Error("PartUnion is required");if(typeof n=="object")return n;if(typeof n=="string")return{text:n};throw new Error(`Unsupported part type: ${typeof n}`)}function G(o,n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("PartListUnion is required");return Array.isArray(n)?n.map(e=>te(o,e)):[te(o,n)]}function Je(o){return o!=null&&typeof o=="object"&&"parts"in o&&Array.isArray(o.parts)}function un(o){return o!=null&&typeof o=="object"&&"functionCall"in o}function Z(o){return!(o==null||un(o))}function We(o){return o==null||Array.isArray(o)&&o.length===0?!1:o.every(Z)}function P(o,n){if(n==null)throw new Error("ContentUnion is required");return Je(n)?n:Z(n)?{role:"user",parts:G(o,n)}:{role:"model",parts:G(o,n)}}function Xe(o,n){if(!n)return[];if(o.isVertexAI()&&Array.isArray(n))return n.flatMap(e=>{const t=P(o,e);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]});if(o.isVertexAI()){const e=P(o,n);return e.parts&&e.parts.length>0&&e.parts[0].text!==void 0?[e.parts[0].text]:[]}return Array.isArray(n)?n.map(e=>P(o,e)):[P(o,n)]}function H(o,n,e){e.length!==0&&(We(e)?n.push({role:"user",parts:G(o,e)}):n.push({role:"model",parts:G(o,e)}),e.length=0)}function cn(o,n,e,t){Z(t)===We(e)||(H(o,n,e),e.length=0),e.push(t)}function I(o,n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("contents are required");if(!Array.isArray(n))return[P(o,n)];const e=[],t=[];for(const i of n)if(Je(i))H(o,e,t),e.push(i);else if(typeof i=="string"||typeof i=="object"&&!Array.isArray(i))cn(o,e,t,i);else if(Array.isArray(i))H(o,e,t),e.push({role:"user",parts:G(o,i)});else throw new Error(`Unsupported content type: ${typeof i}`);return H(o,e,t),e}function K(o,n){if(!o.isVertexAI()&&"default"in n)throw new Error("Default value is not supported in the response schema for the Gemini API.");if("anyOf"in n&&n.anyOf!==void 0)for(const e of n.anyOf)K(o,e);if("items"in n&&n.items!==void 0&&K(o,n.items),"properties"in n&&n.properties!==void 0)for(const e of Object.values(n.properties))K(o,e)}function ze(o,n){return K(o,n),n}function Qe(o,n){if(typeof n=="object"&&"voiceConfig"in n)return n;if(typeof n=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:n}}};throw new Error(`Unsupported speechConfig type: ${typeof n}`)}function be(o,n){return n}function U(o,n){if(!Array.isArray(n))throw new Error("tool is required and must be an array of Tools");return n}function fn(o,n,e,t=1){const i=!n.startsWith(`${e}/`)&&n.split("/").length===t;return o.isVertexAI()?n.startsWith("projects/")?n:n.startsWith("locations/")?`projects/${o.getProject()}/${n}`:n.startsWith(`${e}/`)?`projects/${o.getProject()}/locations/${o.getLocation()}/${n}`:i?`projects/${o.getProject()}/locations/${o.getLocation()}/${e}/${n}`:n:i?`${e}/${n}`:n}function D(o,n){if(typeof n!="string")throw new Error("name must be a string");return fn(o,n,"cachedContents")}function V(o,n){if(typeof n!="string")throw new Error("fromImageBytes must be a string");return n}function Ze(o,n){if(typeof n!="string")throw new Error("fromName must be a string");return n.startsWith("files/")?n.split("files/")[1]:n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function dn(o,n){const e={};if(s(n,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const t=s(n,["thought"]);t!=null&&r(e,["thought"],t);const i=s(n,["codeExecutionResult"]);i!=null&&r(e,["codeExecutionResult"],i);const l=s(n,["executableCode"]);l!=null&&r(e,["executableCode"],l);const u=s(n,["fileData"]);u!=null&&r(e,["fileData"],u);const a=s(n,["functionCall"]);a!=null&&r(e,["functionCall"],a);const c=s(n,["functionResponse"]);c!=null&&r(e,["functionResponse"],c);const f=s(n,["inlineData"]);f!=null&&r(e,["inlineData"],f);const d=s(n,["text"]);return d!=null&&r(e,["text"],d),e}function oe(o,n){const e={},t=s(n,["parts"]);t!=null&&(Array.isArray(t)?r(e,["parts"],t.map(l=>dn(o,l))):r(e,["parts"],t));const i=s(n,["role"]);return i!=null&&r(e,["role"],i),e}function hn(o,n){const e={};if(s(n,["response"])!==void 0)throw new Error("response parameter is not supported in Gemini API.");const t=s(n,["description"]);t!=null&&r(e,["description"],t);const i=s(n,["name"]);i!=null&&r(e,["name"],i);const l=s(n,["parameters"]);return l!=null&&r(e,["parameters"],l),e}function pn(){return{}}function mn(o,n){const e={},t=s(n,["mode"]);t!=null&&r(e,["mode"],t);const i=s(n,["dynamicThreshold"]);return i!=null&&r(e,["dynamicThreshold"],i),e}function gn(o,n){const e={},t=s(n,["dynamicRetrievalConfig"]);return t!=null&&r(e,["dynamicRetrievalConfig"],mn(o,t)),e}function yn(o,n){const e={},t=s(n,["functionDeclarations"]);if(t!=null&&(Array.isArray(t)?r(e,["functionDeclarations"],t.map(a=>hn(o,a))):r(e,["functionDeclarations"],t)),s(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");s(n,["googleSearch"])!=null&&r(e,["googleSearch"],pn());const l=s(n,["googleSearchRetrieval"]);l!=null&&r(e,["googleSearchRetrieval"],gn(o,l));const u=s(n,["codeExecution"]);return u!=null&&r(e,["codeExecution"],u),e}function Cn(o,n){const e={},t=s(n,["mode"]);t!=null&&r(e,["mode"],t);const i=s(n,["allowedFunctionNames"]);return i!=null&&r(e,["allowedFunctionNames"],i),e}function Tn(o,n){const e={},t=s(n,["functionCallingConfig"]);return t!=null&&r(e,["functionCallingConfig"],Cn(o,t)),e}function En(o,n,e){const t={},i=s(n,["ttl"]);e!==void 0&&i!=null&&r(e,["ttl"],i);const l=s(n,["expireTime"]);e!==void 0&&l!=null&&r(e,["expireTime"],l);const u=s(n,["displayName"]);e!==void 0&&u!=null&&r(e,["displayName"],u);const a=s(n,["contents"]);e!==void 0&&a!=null&&(Array.isArray(a)?r(e,["contents"],I(o,I(o,a).map(h=>oe(o,h)))):r(e,["contents"],I(o,a)));const c=s(n,["systemInstruction"]);e!==void 0&&c!=null&&r(e,["systemInstruction"],oe(o,P(o,c)));const f=s(n,["tools"]);e!==void 0&&f!=null&&(Array.isArray(f)?r(e,["tools"],f.map(h=>yn(o,h))):r(e,["tools"],f));const d=s(n,["toolConfig"]);return e!==void 0&&d!=null&&r(e,["toolConfig"],Tn(o,d)),t}function vn(o,n){const e={},t=s(n,["model"]);t!=null&&r(e,["model"],$e(o,t));const i=s(n,["config"]);return i!=null&&r(e,["config"],En(o,i,e)),e}function _n(o,n){const e={},t=s(n,["name"]);t!=null&&r(e,["_url","name"],D(o,t));const i=s(n,["config"]);return i!=null&&r(e,["config"],i),e}function In(o,n){const e={},t=s(n,["name"]);t!=null&&r(e,["_url","name"],D(o,t));const i=s(n,["config"]);return i!=null&&r(e,["config"],i),e}function An(o,n,e){const t={},i=s(n,["ttl"]);e!==void 0&&i!=null&&r(e,["ttl"],i);const l=s(n,["expireTime"]);return e!==void 0&&l!=null&&r(e,["expireTime"],l),t}function Mn(o,n){const e={},t=s(n,["name"]);t!=null&&r(e,["_url","name"],D(o,t));const i=s(n,["config"]);return i!=null&&r(e,["config"],An(o,i,e)),e}function Sn(o,n,e){const t={},i=s(n,["pageSize"]);e!==void 0&&i!=null&&r(e,["_query","pageSize"],i);const l=s(n,["pageToken"]);return e!==void 0&&l!=null&&r(e,["_query","pageToken"],l),t}function Pn(o,n){const e={},t=s(n,["config"]);return t!=null&&r(e,["config"],Sn(o,t,e)),e}function Rn(o,n){const e={},t=s(n,["videoMetadata"]);t!=null&&r(e,["videoMetadata"],t);const i=s(n,["thought"]);i!=null&&r(e,["thought"],i);const l=s(n,["codeExecutionResult"]);l!=null&&r(e,["codeExecutionResult"],l);const u=s(n,["executableCode"]);u!=null&&r(e,["executableCode"],u);const a=s(n,["fileData"]);a!=null&&r(e,["fileData"],a);const c=s(n,["functionCall"]);c!=null&&r(e,["functionCall"],c);const f=s(n,["functionResponse"]);f!=null&&r(e,["functionResponse"],f);const d=s(n,["inlineData"]);d!=null&&r(e,["inlineData"],d);const h=s(n,["text"]);return h!=null&&r(e,["text"],h),e}function ie(o,n){const e={},t=s(n,["parts"]);t!=null&&(Array.isArray(t)?r(e,["parts"],t.map(l=>Rn(o,l))):r(e,["parts"],t));const i=s(n,["role"]);return i!=null&&r(e,["role"],i),e}function xn(o,n){const e={},t=s(n,["example"]);t!=null&&r(e,["example"],t);const i=s(n,["pattern"]);i!=null&&r(e,["pattern"],i);const l=s(n,["default"]);l!=null&&r(e,["default"],l);const u=s(n,["maxLength"]);u!=null&&r(e,["maxLength"],u);const a=s(n,["minLength"]);a!=null&&r(e,["minLength"],a);const c=s(n,["minProperties"]);c!=null&&r(e,["minProperties"],c);const f=s(n,["maxProperties"]);f!=null&&r(e,["maxProperties"],f);const d=s(n,["anyOf"]);d!=null&&r(e,["anyOf"],d);const h=s(n,["description"]);h!=null&&r(e,["description"],h);const g=s(n,["enum"]);g!=null&&r(e,["enum"],g);const p=s(n,["format"]);p!=null&&r(e,["format"],p);const m=s(n,["items"]);m!=null&&r(e,["items"],m);const y=s(n,["maxItems"]);y!=null&&r(e,["maxItems"],y);const C=s(n,["maximum"]);C!=null&&r(e,["maximum"],C);const v=s(n,["minItems"]);v!=null&&r(e,["minItems"],v);const T=s(n,["minimum"]);T!=null&&r(e,["minimum"],T);const _=s(n,["nullable"]);_!=null&&r(e,["nullable"],_);const S=s(n,["properties"]);S!=null&&r(e,["properties"],S);const R=s(n,["propertyOrdering"]);R!=null&&r(e,["propertyOrdering"],R);const x=s(n,["required"]);x!=null&&r(e,["required"],x);const w=s(n,["title"]);w!=null&&r(e,["title"],w);const N=s(n,["type"]);return N!=null&&r(e,["type"],N),e}function wn(o,n){const e={},t=s(n,["response"]);t!=null&&r(e,["response"],xn(o,t));const i=s(n,["description"]);i!=null&&r(e,["description"],i);const l=s(n,["name"]);l!=null&&r(e,["name"],l);const u=s(n,["parameters"]);return u!=null&&r(e,["parameters"],u),e}function Nn(){return{}}function Dn(o,n){const e={},t=s(n,["mode"]);t!=null&&r(e,["mode"],t);const i=s(n,["dynamicThreshold"]);return i!=null&&r(e,["dynamicThreshold"],i),e}function Vn(o,n){const e={},t=s(n,["dynamicRetrievalConfig"]);return t!=null&&r(e,["dynamicRetrievalConfig"],Dn(o,t)),e}function Fn(o,n){const e={},t=s(n,["functionDeclarations"]);t!=null&&(Array.isArray(t)?r(e,["functionDeclarations"],t.map(c=>wn(o,c))):r(e,["functionDeclarations"],t));const i=s(n,["retrieval"]);i!=null&&r(e,["retrieval"],i),s(n,["googleSearch"])!=null&&r(e,["googleSearch"],Nn());const u=s(n,["googleSearchRetrieval"]);u!=null&&r(e,["googleSearchRetrieval"],Vn(o,u));const a=s(n,["codeExecution"]);return a!=null&&r(e,["codeExecution"],a),e}function Ln(o,n){const e={},t=s(n,["mode"]);t!=null&&r(e,["mode"],t);const i=s(n,["allowedFunctionNames"]);return i!=null&&r(e,["allowedFunctionNames"],i),e}function Un(o,n){const e={},t=s(n,["functionCallingConfig"]);return t!=null&&r(e,["functionCallingConfig"],Ln(o,t)),e}function qn(o,n,e){const t={},i=s(n,["ttl"]);e!==void 0&&i!=null&&r(e,["ttl"],i);const l=s(n,["expireTime"]);e!==void 0&&l!=null&&r(e,["expireTime"],l);const u=s(n,["displayName"]);e!==void 0&&u!=null&&r(e,["displayName"],u);const a=s(n,["contents"]);e!==void 0&&a!=null&&(Array.isArray(a)?r(e,["contents"],I(o,I(o,a).map(h=>ie(o,h)))):r(e,["contents"],I(o,a)));const c=s(n,["systemInstruction"]);e!==void 0&&c!=null&&r(e,["systemInstruction"],ie(o,P(o,c)));const f=s(n,["tools"]);e!==void 0&&f!=null&&(Array.isArray(f)?r(e,["tools"],f.map(h=>Fn(o,h))):r(e,["tools"],f));const d=s(n,["toolConfig"]);return e!==void 0&&d!=null&&r(e,["toolConfig"],Un(o,d)),t}function Gn(o,n){const e={},t=s(n,["model"]);t!=null&&r(e,["model"],$e(o,t));const i=s(n,["config"]);return i!=null&&r(e,["config"],qn(o,i,e)),e}function kn(o,n){const e={},t=s(n,["name"]);t!=null&&r(e,["_url","name"],D(o,t));const i=s(n,["config"]);return i!=null&&r(e,["config"],i),e}function Bn(o,n){const e={},t=s(n,["name"]);t!=null&&r(e,["_url","name"],D(o,t));const i=s(n,["config"]);return i!=null&&r(e,["config"],i),e}function Hn(o,n,e){const t={},i=s(n,["ttl"]);e!==void 0&&i!=null&&r(e,["ttl"],i);const l=s(n,["expireTime"]);return e!==void 0&&l!=null&&r(e,["expireTime"],l),t}function Kn(o,n){const e={},t=s(n,["name"]);t!=null&&r(e,["_url","name"],D(o,t));const i=s(n,["config"]);return i!=null&&r(e,["config"],Hn(o,i,e)),e}function On(o,n,e){const t={},i=s(n,["pageSize"]);e!==void 0&&i!=null&&r(e,["_query","pageSize"],i);const l=s(n,["pageToken"]);return e!==void 0&&l!=null&&r(e,["_query","pageToken"],l),t}function Yn(o,n){const e={},t=s(n,["config"]);return t!=null&&r(e,["config"],On(o,t,e)),e}function O(o,n){const e={},t=s(n,["name"]);t!=null&&r(e,["name"],t);const i=s(n,["displayName"]);i!=null&&r(e,["displayName"],i);const l=s(n,["model"]);l!=null&&r(e,["model"],l);const u=s(n,["createTime"]);u!=null&&r(e,["createTime"],u);const a=s(n,["updateTime"]);a!=null&&r(e,["updateTime"],a);const c=s(n,["expireTime"]);c!=null&&r(e,["expireTime"],c);const f=s(n,["usageMetadata"]);return f!=null&&r(e,["usageMetadata"],f),e}function $n(){return{}}function Jn(o,n){const e={},t=s(n,["nextPageToken"]);t!=null&&r(e,["nextPageToken"],t);const i=s(n,["cachedContents"]);return i!=null&&(Array.isArray(i)?r(e,["cachedContents"],i.map(l=>O(o,l))):r(e,["cachedContents"],i)),e}function Y(o,n){const e={},t=s(n,["name"]);t!=null&&r(e,["name"],t);const i=s(n,["displayName"]);i!=null&&r(e,["displayName"],i);const l=s(n,["model"]);l!=null&&r(e,["model"],l);const u=s(n,["createTime"]);u!=null&&r(e,["createTime"],u);const a=s(n,["updateTime"]);a!=null&&r(e,["updateTime"],a);const c=s(n,["expireTime"]);c!=null&&r(e,["expireTime"],c);const f=s(n,["usageMetadata"]);return f!=null&&r(e,["usageMetadata"],f),e}function Wn(){return{}}function Xn(o,n){const e={},t=s(n,["nextPageToken"]);t!=null&&r(e,["nextPageToken"],t);const i=s(n,["cachedContents"]);return i!=null&&(Array.isArray(i)?r(e,["cachedContents"],i.map(l=>Y(o,l))):r(e,["cachedContents"],i)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var $;(function(o){o.PAGED_ITEM_BATCH_JOBS="batchJobs",o.PAGED_ITEM_MODELS="models",o.PAGED_ITEM_TUNING_JOBS="tuningJobs",o.PAGED_ITEM_FILES="files",o.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})($||($={}));class je{constructor(n,e,t,i){this.pageInternal=[],this.paramsInternal={},this.requestInternal=e,this.init(n,t,i)}init(n,e,t){var i,l;this.nameInternal=n,this.pageInternal=e[this.nameInternal]||[],this.idxInternal=0;let u={config:{}};t?typeof t=="object"?u=Object.assign({},t):u=t:u={config:{}},u.config&&(u.config.pageToken=e.nextPageToken),this.paramsInternal=u,this.pageInternalSize=(l=(i=u.config)===null||i===void 0?void 0:i.pageSize)!==null&&l!==void 0?l:this.pageInternal.length}initNextPage(n){this.init(this.nameInternal,n,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(n){return this.pageInternal[n]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const n=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:n,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const n=await this.requestInternal(this.params);return this.initNextPage(n),this.page}hasNextPage(){var n;return((n=this.params.config)===null||n===void 0?void 0:n.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var re;(function(o){o.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",o.OUTCOME_OK="OUTCOME_OK",o.OUTCOME_FAILED="OUTCOME_FAILED",o.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(re||(re={}));var se;(function(o){o.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",o.PYTHON="PYTHON"})(se||(se={}));var le;(function(o){o.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",o.STRING="STRING",o.NUMBER="NUMBER",o.INTEGER="INTEGER",o.BOOLEAN="BOOLEAN",o.ARRAY="ARRAY",o.OBJECT="OBJECT"})(le||(le={}));var ae;(function(o){o.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",o.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",o.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",o.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",o.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",o.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(ae||(ae={}));var ue;(function(o){o.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",o.SEVERITY="SEVERITY",o.PROBABILITY="PROBABILITY"})(ue||(ue={}));var ce;(function(o){o.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",o.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",o.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",o.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",o.BLOCK_NONE="BLOCK_NONE",o.OFF="OFF"})(ce||(ce={}));var fe;(function(o){o.MODE_UNSPECIFIED="MODE_UNSPECIFIED",o.MODE_DYNAMIC="MODE_DYNAMIC"})(fe||(fe={}));var de;(function(o){o.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",o.STOP="STOP",o.MAX_TOKENS="MAX_TOKENS",o.SAFETY="SAFETY",o.RECITATION="RECITATION",o.OTHER="OTHER",o.BLOCKLIST="BLOCKLIST",o.PROHIBITED_CONTENT="PROHIBITED_CONTENT",o.SPII="SPII",o.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",o.IMAGE_SAFETY="IMAGE_SAFETY"})(de||(de={}));var he;(function(o){o.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",o.NEGLIGIBLE="NEGLIGIBLE",o.LOW="LOW",o.MEDIUM="MEDIUM",o.HIGH="HIGH"})(he||(he={}));var pe;(function(o){o.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",o.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",o.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",o.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",o.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(pe||(pe={}));var me;(function(o){o.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",o.SAFETY="SAFETY",o.OTHER="OTHER",o.BLOCKLIST="BLOCKLIST",o.PROHIBITED_CONTENT="PROHIBITED_CONTENT"})(me||(me={}));var ge;(function(o){o.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",o.TEXT="TEXT",o.IMAGE="IMAGE",o.AUDIO="AUDIO"})(ge||(ge={}));var ye;(function(o){o.STATE_UNSPECIFIED="STATE_UNSPECIFIED",o.ACTIVE="ACTIVE",o.ERROR="ERROR"})(ye||(ye={}));var Ce;(function(o){o.MODE_UNSPECIFIED="MODE_UNSPECIFIED",o.MODE_DYNAMIC="MODE_DYNAMIC"})(Ce||(Ce={}));var Te;(function(o){o.MODE_UNSPECIFIED="MODE_UNSPECIFIED",o.AUTO="AUTO",o.ANY="ANY",o.NONE="NONE"})(Te||(Te={}));var Ee;(function(o){o.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",o.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",o.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",o.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(Ee||(Ee={}));var ve;(function(o){o.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",o.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",o.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",o.BLOCK_NONE="BLOCK_NONE"})(ve||(ve={}));var _e;(function(o){o.DONT_ALLOW="DONT_ALLOW",o.ALLOW_ADULT="ALLOW_ADULT",o.ALLOW_ALL="ALLOW_ALL"})(_e||(_e={}));var Ie;(function(o){o.auto="auto",o.en="en",o.ja="ja",o.ko="ko",o.hi="hi"})(Ie||(Ie={}));var Ae;(function(o){o.STATE_UNSPECIFIED="STATE_UNSPECIFIED",o.PROCESSING="PROCESSING",o.ACTIVE="ACTIVE",o.FAILED="FAILED"})(Ae||(Ae={}));var Me;(function(o){o.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",o.UPLOADED="UPLOADED",o.GENERATED="GENERATED"})(Me||(Me={}));var Se;(function(o){o.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",o.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",o.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",o.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",o.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(Se||(Se={}));var Pe;(function(o){o.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",o.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",o.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",o.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(Pe||(Pe={}));var Re;(function(o){o.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",o.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",o.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",o.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(Re||(Re={}));var xe;(function(o){o.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",o.TEXT="TEXT",o.IMAGE="IMAGE",o.VIDEO="VIDEO",o.AUDIO="AUDIO",o.DOCUMENT="DOCUMENT"})(xe||(xe={}));class B{get text(){var n,e,t,i,l,u,a,c;if(((i=(t=(e=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||e===void 0?void 0:e.content)===null||t===void 0?void 0:t.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let f="",d=!1;const h=[];for(const g of(c=(a=(u=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||u===void 0?void 0:u.content)===null||a===void 0?void 0:a.parts)!==null&&c!==void 0?c:[]){for(const[p,m]of Object.entries(g))p!=="text"&&p!=="thought"&&(m!==null||m!==void 0)&&h.push(p);if(typeof g.text=="string"){if(typeof g.thought=="boolean"&&g.thought)continue;d=!0,f+=g.text}}return h.length>0&&console.warn(`there are non-text parts ${h} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),d?f:void 0}get functionCalls(){var n,e,t,i,l,u,a,c;if(((i=(t=(e=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||e===void 0?void 0:e.content)===null||t===void 0?void 0:t.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const f=(c=(a=(u=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||u===void 0?void 0:u.content)===null||a===void 0?void 0:a.parts)===null||c===void 0?void 0:c.filter(d=>d.functionCall).map(d=>d.functionCall).filter(d=>d!==void 0);if((f==null?void 0:f.length)!==0)return f}get executableCode(){var n,e,t,i,l,u,a,c,f;if(((i=(t=(e=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||e===void 0?void 0:e.content)===null||t===void 0?void 0:t.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const d=(c=(a=(u=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||u===void 0?void 0:u.content)===null||a===void 0?void 0:a.parts)===null||c===void 0?void 0:c.filter(h=>h.executableCode).map(h=>h.executableCode).filter(h=>h!==void 0);if((d==null?void 0:d.length)!==0)return(f=d==null?void 0:d[0])===null||f===void 0?void 0:f.code}get codeExecutionResult(){var n,e,t,i,l,u,a,c,f;if(((i=(t=(e=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||e===void 0?void 0:e.content)===null||t===void 0?void 0:t.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const d=(c=(a=(u=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||u===void 0?void 0:u.content)===null||a===void 0?void 0:a.parts)===null||c===void 0?void 0:c.filter(h=>h.codeExecutionResult).map(h=>h.codeExecutionResult).filter(h=>h!==void 0);if((d==null?void 0:d.length)!==0)return(f=d==null?void 0:d[0])===null||f===void 0?void 0:f.output}}class we{}class Ne{}class De{}class zn{}class Ve{}class Fe{}class Qn{}class en{constructor(n){const e={};for(const t of n.headers.entries())e[t[0]]=t[1];this.headers=e,this.responseInternal=n}json(){return this.responseInternal.json()}}class bn{}class Zn{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class jn extends W{constructor(n){super(),this.apiClient=n,this.list=async(e={})=>new je($.PAGED_ITEM_CACHED_CONTENTS,t=>this.listInternal(t),await this.listInternal(e),e)}async create(n){var e,t;let i,l="",u={};if(this.apiClient.isVertexAI()){const a=Gn(this.apiClient,n);return l=E("cachedContents",a._url),u=a._query,delete a.config,delete a._url,delete a._query,i=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(e=n.config)===null||e===void 0?void 0:e.httpOptions}).then(c=>c.json()),i.then(c=>Y(this.apiClient,c))}else{const a=vn(this.apiClient,n);return l=E("cachedContents",a._url),u=a._query,delete a.config,delete a._url,delete a._query,i=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions}).then(c=>c.json()),i.then(c=>O(this.apiClient,c))}}async get(n){var e,t;let i,l="",u={};if(this.apiClient.isVertexAI()){const a=kn(this.apiClient,n);return l=E("{name}",a._url),u=a._query,delete a.config,delete a._url,delete a._query,i=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(e=n.config)===null||e===void 0?void 0:e.httpOptions}).then(c=>c.json()),i.then(c=>Y(this.apiClient,c))}else{const a=_n(this.apiClient,n);return l=E("{name}",a._url),u=a._query,delete a.config,delete a._url,delete a._query,i=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions}).then(c=>c.json()),i.then(c=>O(this.apiClient,c))}}async delete(n){var e,t;let i,l="",u={};if(this.apiClient.isVertexAI()){const a=Bn(this.apiClient,n);return l=E("{name}",a._url),u=a._query,delete a.config,delete a._url,delete a._query,i=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(a),httpMethod:"DELETE",httpOptions:(e=n.config)===null||e===void 0?void 0:e.httpOptions}).then(c=>c.json()),i.then(()=>{const c=Wn(),f=new Ve;return Object.assign(f,c),f})}else{const a=In(this.apiClient,n);return l=E("{name}",a._url),u=a._query,delete a.config,delete a._url,delete a._query,i=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(a),httpMethod:"DELETE",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions}).then(c=>c.json()),i.then(()=>{const c=$n(),f=new Ve;return Object.assign(f,c),f})}}async update(n){var e,t;let i,l="",u={};if(this.apiClient.isVertexAI()){const a=Kn(this.apiClient,n);return l=E("{name}",a._url),u=a._query,delete a.config,delete a._url,delete a._query,i=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(a),httpMethod:"PATCH",httpOptions:(e=n.config)===null||e===void 0?void 0:e.httpOptions}).then(c=>c.json()),i.then(c=>Y(this.apiClient,c))}else{const a=Mn(this.apiClient,n);return l=E("{name}",a._url),u=a._query,delete a.config,delete a._url,delete a._query,i=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(a),httpMethod:"PATCH",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions}).then(c=>c.json()),i.then(c=>O(this.apiClient,c))}}async listInternal(n){var e,t;let i,l="",u={};if(this.apiClient.isVertexAI()){const a=Yn(this.apiClient,n);return l=E("cachedContents",a._url),u=a._query,delete a.config,delete a._url,delete a._query,i=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(e=n.config)===null||e===void 0?void 0:e.httpOptions}).then(c=>c.json()),i.then(c=>{const f=Xn(this.apiClient,c),d=new Fe;return Object.assign(d,f),d})}else{const a=Pn(this.apiClient,n);return l=E("cachedContents",a._url),u=a._query,delete a.config,delete a._url,delete a._query,i=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions}).then(c=>c.json()),i.then(c=>{const f=Jn(this.apiClient,c),d=new Fe;return Object.assign(d,f),d})}}}function Le(o){var n=typeof Symbol=="function"&&Symbol.iterator,e=n&&o[n],t=0;if(e)return e.call(o);if(o&&typeof o.length=="number")return{next:function(){return o&&t>=o.length&&(o=void 0),{value:o&&o[t++],done:!o}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}function A(o){return this instanceof A?(this.v=o,this):new A(o)}function J(o,n,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e.apply(o,n||[]),i,l=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",u),i[Symbol.asyncIterator]=function(){return this},i;function u(p){return function(m){return Promise.resolve(m).then(p,h)}}function a(p,m){t[p]&&(i[p]=function(y){return new Promise(function(C,v){l.push([p,y,C,v])>1||c(p,y)})},m&&(i[p]=m(i[p])))}function c(p,m){try{f(t[p](m))}catch(y){g(l[0][3],y)}}function f(p){p.value instanceof A?Promise.resolve(p.value.v).then(d,h):g(l[0][2],p)}function d(p){c("next",p)}function h(p){c("throw",p)}function g(p,m){p(m),l.shift(),l.length&&c(l[0][0],l[0][1])}}function Q(o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=o[Symbol.asyncIterator],e;return n?n.call(o):(o=typeof Le=="function"?Le(o):o[Symbol.iterator](),e={},t("next"),t("throw"),t("return"),e[Symbol.asyncIterator]=function(){return this},e);function t(l){e[l]=o[l]&&function(u){return new Promise(function(a,c){u=o[l](u),i(a,c,u.done,u.value)})}}function i(l,u,a,c){Promise.resolve(c).then(function(f){l({value:f,done:a})},u)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function et(o){var n;if(o.candidates==null||o.candidates.length===0)return!1;const e=(n=o.candidates[0])===null||n===void 0?void 0:n.content;return e===void 0?!1:nn(e)}function nn(o){if(o.parts===void 0||o.parts.length===0)return!1;for(const n of o.parts)if(n===void 0||Object.keys(n).length===0||n.text!==void 0&&n.text==="")return!1;return!0}function nt(o){if(o.length!==0){if(o[0].role!=="user")throw new Error("History must start with a user turn.");for(const n of o)if(n.role!=="user"&&n.role!=="model")throw new Error(`Role must be user or model, but got ${n.role}.`)}}function tt(o){if(o===void 0||o.length===0)return[];const n=[],e=o.length;let t=0,i=o[0];for(;t<e;)if(o[t].role==="user")i=o[t],t++;else{const l=[];let u=!0;for(;t<e&&o[t].role==="model";)l.push(o[t]),u&&!nn(o[t])&&(u=!1),t++;u&&(n.push(i),n.push(...l))}return n}class ot{constructor(n,e){this.modelsModule=n,this.apiClient=e}create(n){return new it(this.apiClient,this.modelsModule,n.model,n.config,n.history)}}class it{constructor(n,e,t,i={},l=[]){this.apiClient=n,this.modelsModule=e,this.model=t,this.config=i,this.history=l,this.sendPromise=Promise.resolve(),nt(l)}async sendMessage(n){var e;await this.sendPromise;const t=P(this.apiClient,n.message),i=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(t),config:(e=n.config)!==null&&e!==void 0?e:this.config});return this.sendPromise=(async()=>{var l,u;const c=(u=(l=(await i).candidates)===null||l===void 0?void 0:l[0])===null||u===void 0?void 0:u.content,f=c?[c]:[];this.recordHistory(t,f)})(),await this.sendPromise,i}async sendMessageStream(n){var e;await this.sendPromise;const t=P(this.apiClient,n.message),i=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(t),config:(e=n.config)!==null&&e!==void 0?e:this.config});this.sendPromise=i.then(()=>{});const l=await i;return this.processStreamResponse(l,t)}getHistory(n=!1){return n?tt(this.history):this.history}processStreamResponse(n,e){var t,i;return J(this,arguments,function*(){var u,a,c,f;const d=[];try{for(var h=!0,g=Q(n),p;p=yield A(g.next()),u=p.done,!u;h=!0){f=p.value,h=!1;const m=f;if(et(m)){const y=(i=(t=m.candidates)===null||t===void 0?void 0:t[0])===null||i===void 0?void 0:i.content;y!==void 0&&d.push(y)}yield yield A(m)}}catch(m){a={error:m}}finally{try{!h&&!u&&(c=g.return)&&(yield A(c.call(g)))}finally{if(a)throw a.error}}this.recordHistory(e,d)})}recordHistory(n,e){let t=[];e.length>0&&e.every(i=>i.role==="model")?t=e:t.push({role:"model",parts:[]}),this.history.push(n),this.history.push(...t)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function rt(o,n,e){const t={},i=s(n,["pageSize"]);e!==void 0&&i!=null&&r(e,["_query","pageSize"],i);const l=s(n,["pageToken"]);return e!==void 0&&l!=null&&r(e,["_query","pageToken"],l),t}function st(o,n){const e={},t=s(n,["config"]);return t!=null&&r(e,["config"],rt(o,t,e)),e}function lt(o,n){const e={},t=s(n,["details"]);t!=null&&r(e,["details"],t);const i=s(n,["message"]);i!=null&&r(e,["message"],i);const l=s(n,["code"]);return l!=null&&r(e,["code"],l),e}function at(o,n){const e={},t=s(n,["name"]);t!=null&&r(e,["name"],t);const i=s(n,["displayName"]);i!=null&&r(e,["displayName"],i);const l=s(n,["mimeType"]);l!=null&&r(e,["mimeType"],l);const u=s(n,["sizeBytes"]);u!=null&&r(e,["sizeBytes"],u);const a=s(n,["createTime"]);a!=null&&r(e,["createTime"],a);const c=s(n,["expirationTime"]);c!=null&&r(e,["expirationTime"],c);const f=s(n,["updateTime"]);f!=null&&r(e,["updateTime"],f);const d=s(n,["sha256Hash"]);d!=null&&r(e,["sha256Hash"],d);const h=s(n,["uri"]);h!=null&&r(e,["uri"],h);const g=s(n,["downloadUri"]);g!=null&&r(e,["downloadUri"],g);const p=s(n,["state"]);p!=null&&r(e,["state"],p);const m=s(n,["source"]);m!=null&&r(e,["source"],m);const y=s(n,["videoMetadata"]);y!=null&&r(e,["videoMetadata"],y);const C=s(n,["error"]);return C!=null&&r(e,["error"],lt(o,C)),e}function ut(o,n){const e={},t=s(n,["file"]);t!=null&&r(e,["file"],at(o,t));const i=s(n,["config"]);return i!=null&&r(e,["config"],i),e}function ct(o,n){const e={},t=s(n,["name"]);t!=null&&r(e,["_url","file"],Ze(o,t));const i=s(n,["config"]);return i!=null&&r(e,["config"],i),e}function ft(o,n){const e={},t=s(n,["name"]);t!=null&&r(e,["_url","file"],Ze(o,t));const i=s(n,["config"]);return i!=null&&r(e,["config"],i),e}function dt(o,n){const e={},t=s(n,["details"]);t!=null&&r(e,["details"],t);const i=s(n,["message"]);i!=null&&r(e,["message"],i);const l=s(n,["code"]);return l!=null&&r(e,["code"],l),e}function b(o,n){const e={},t=s(n,["name"]);t!=null&&r(e,["name"],t);const i=s(n,["displayName"]);i!=null&&r(e,["displayName"],i);const l=s(n,["mimeType"]);l!=null&&r(e,["mimeType"],l);const u=s(n,["sizeBytes"]);u!=null&&r(e,["sizeBytes"],u);const a=s(n,["createTime"]);a!=null&&r(e,["createTime"],a);const c=s(n,["expirationTime"]);c!=null&&r(e,["expirationTime"],c);const f=s(n,["updateTime"]);f!=null&&r(e,["updateTime"],f);const d=s(n,["sha256Hash"]);d!=null&&r(e,["sha256Hash"],d);const h=s(n,["uri"]);h!=null&&r(e,["uri"],h);const g=s(n,["downloadUri"]);g!=null&&r(e,["downloadUri"],g);const p=s(n,["state"]);p!=null&&r(e,["state"],p);const m=s(n,["source"]);m!=null&&r(e,["source"],m);const y=s(n,["videoMetadata"]);y!=null&&r(e,["videoMetadata"],y);const C=s(n,["error"]);return C!=null&&r(e,["error"],dt(o,C)),e}function ht(o,n){const e={},t=s(n,["nextPageToken"]);t!=null&&r(e,["nextPageToken"],t);const i=s(n,["files"]);return i!=null&&(Array.isArray(i)?r(e,["files"],i.map(l=>b(o,l))):r(e,["files"],i)),e}function pt(o,n){const e={},t=s(n,["httpHeaders"]);return t!=null&&r(e,["httpHeaders"],t),e}function mt(){return{}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class gt extends W{constructor(n){super(),this.apiClient=n,this.list=async(e={})=>new je($.PAGED_ITEM_FILES,t=>this.listInternal(t),await this.listInternal(e),e)}async upload(n){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(n.file,n.config).then(e=>b(this.apiClient,e))}async listInternal(n){var e;let t,i="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=st(this.apiClient,n);return i=E("files",u._url),l=u._query,delete u.config,delete u._url,delete u._query,t=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(e=n.config)===null||e===void 0?void 0:e.httpOptions}).then(a=>a.json()),t.then(a=>{const c=ht(this.apiClient,a),f=new Qn;return Object.assign(f,c),f})}}async createInternal(n){var e;let t,i="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=ut(this.apiClient,n);return i=E("upload/v1beta/files",u._url),l=u._query,delete u.config,delete u._url,delete u._query,t=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(e=n.config)===null||e===void 0?void 0:e.httpOptions}).then(a=>a.json()),t.then(a=>{const c=pt(this.apiClient,a),f=new bn;return Object.assign(f,c),f})}}async get(n){var e;let t,i="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=ct(this.apiClient,n);return i=E("files/{file}",u._url),l=u._query,delete u.config,delete u._url,delete u._query,t=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(e=n.config)===null||e===void 0?void 0:e.httpOptions}).then(a=>a.json()),t.then(a=>b(this.apiClient,a))}}async delete(n){var e;let t,i="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=ft(this.apiClient,n);return i=E("files/{file}",u._url),l=u._query,delete u.config,delete u._url,delete u._query,t=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(e=n.config)===null||e===void 0?void 0:e.httpOptions}).then(a=>a.json()),t.then(()=>{const a=mt(),c=new Zn;return Object.assign(c,a),c})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function yt(o,n){const e={};if(s(n,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const t=s(n,["thought"]);t!=null&&r(e,["thought"],t);const i=s(n,["codeExecutionResult"]);i!=null&&r(e,["codeExecutionResult"],i);const l=s(n,["executableCode"]);l!=null&&r(e,["executableCode"],l);const u=s(n,["fileData"]);u!=null&&r(e,["fileData"],u);const a=s(n,["functionCall"]);a!=null&&r(e,["functionCall"],a);const c=s(n,["functionResponse"]);c!=null&&r(e,["functionResponse"],c);const f=s(n,["inlineData"]);f!=null&&r(e,["inlineData"],f);const d=s(n,["text"]);return d!=null&&r(e,["text"],d),e}function k(o,n){const e={},t=s(n,["parts"]);t!=null&&(Array.isArray(t)?r(e,["parts"],t.map(l=>yt(o,l))):r(e,["parts"],t));const i=s(n,["role"]);return i!=null&&r(e,["role"],i),e}function Ct(o,n){const e={};if(s(n,["example"])!==void 0)throw new Error("example parameter is not supported in Gemini API.");if(s(n,["pattern"])!==void 0)throw new Error("pattern parameter is not supported in Gemini API.");if(s(n,["default"])!==void 0)throw new Error("default parameter is not supported in Gemini API.");if(s(n,["maxLength"])!==void 0)throw new Error("maxLength parameter is not supported in Gemini API.");if(s(n,["minLength"])!==void 0)throw new Error("minLength parameter is not supported in Gemini API.");if(s(n,["minProperties"])!==void 0)throw new Error("minProperties parameter is not supported in Gemini API.");if(s(n,["maxProperties"])!==void 0)throw new Error("maxProperties parameter is not supported in Gemini API.");const t=s(n,["anyOf"]);t!=null&&r(e,["anyOf"],t);const i=s(n,["description"]);i!=null&&r(e,["description"],i);const l=s(n,["enum"]);l!=null&&r(e,["enum"],l);const u=s(n,["format"]);u!=null&&r(e,["format"],u);const a=s(n,["items"]);a!=null&&r(e,["items"],a);const c=s(n,["maxItems"]);c!=null&&r(e,["maxItems"],c);const f=s(n,["maximum"]);f!=null&&r(e,["maximum"],f);const d=s(n,["minItems"]);d!=null&&r(e,["minItems"],d);const h=s(n,["minimum"]);h!=null&&r(e,["minimum"],h);const g=s(n,["nullable"]);g!=null&&r(e,["nullable"],g);const p=s(n,["properties"]);p!=null&&r(e,["properties"],p);const m=s(n,["propertyOrdering"]);m!=null&&r(e,["propertyOrdering"],m);const y=s(n,["required"]);y!=null&&r(e,["required"],y);const C=s(n,["title"]);C!=null&&r(e,["title"],C);const v=s(n,["type"]);return v!=null&&r(e,["type"],v),e}function Tt(o,n){const e={};if(s(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const t=s(n,["category"]);t!=null&&r(e,["category"],t);const i=s(n,["threshold"]);return i!=null&&r(e,["threshold"],i),e}function Et(o,n){const e={};if(s(n,["response"])!==void 0)throw new Error("response parameter is not supported in Gemini API.");const t=s(n,["description"]);t!=null&&r(e,["description"],t);const i=s(n,["name"]);i!=null&&r(e,["name"],i);const l=s(n,["parameters"]);return l!=null&&r(e,["parameters"],l),e}function vt(){return{}}function _t(o,n){const e={},t=s(n,["mode"]);t!=null&&r(e,["mode"],t);const i=s(n,["dynamicThreshold"]);return i!=null&&r(e,["dynamicThreshold"],i),e}function It(o,n){const e={},t=s(n,["dynamicRetrievalConfig"]);return t!=null&&r(e,["dynamicRetrievalConfig"],_t(o,t)),e}function tn(o,n){const e={},t=s(n,["functionDeclarations"]);if(t!=null&&(Array.isArray(t)?r(e,["functionDeclarations"],t.map(a=>Et(o,a))):r(e,["functionDeclarations"],t)),s(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");s(n,["googleSearch"])!=null&&r(e,["googleSearch"],vt());const l=s(n,["googleSearchRetrieval"]);l!=null&&r(e,["googleSearchRetrieval"],It(o,l));const u=s(n,["codeExecution"]);return u!=null&&r(e,["codeExecution"],u),e}function At(o,n){const e={},t=s(n,["mode"]);t!=null&&r(e,["mode"],t);const i=s(n,["allowedFunctionNames"]);return i!=null&&r(e,["allowedFunctionNames"],i),e}function Mt(o,n){const e={},t=s(n,["functionCallingConfig"]);return t!=null&&r(e,["functionCallingConfig"],At(o,t)),e}function St(o,n){const e={},t=s(n,["voiceName"]);return t!=null&&r(e,["voiceName"],t),e}function Pt(o,n){const e={},t=s(n,["prebuiltVoiceConfig"]);return t!=null&&r(e,["prebuiltVoiceConfig"],St(o,t)),e}function Rt(o,n){const e={},t=s(n,["voiceConfig"]);return t!=null&&r(e,["voiceConfig"],Pt(o,t)),e}function xt(o,n){const e={},t=s(n,["includeThoughts"]);return t!=null&&r(e,["includeThoughts"],t),e}function wt(o,n,e){const t={},i=s(n,["systemInstruction"]);e!==void 0&&i!=null&&r(e,["systemInstruction"],k(o,P(o,i)));const l=s(n,["temperature"]);l!=null&&r(t,["temperature"],l);const u=s(n,["topP"]);u!=null&&r(t,["topP"],u);const a=s(n,["topK"]);a!=null&&r(t,["topK"],a);const c=s(n,["candidateCount"]);c!=null&&r(t,["candidateCount"],c);const f=s(n,["maxOutputTokens"]);f!=null&&r(t,["maxOutputTokens"],f);const d=s(n,["stopSequences"]);d!=null&&r(t,["stopSequences"],d);const h=s(n,["responseLogprobs"]);h!=null&&r(t,["responseLogprobs"],h);const g=s(n,["logprobs"]);g!=null&&r(t,["logprobs"],g);const p=s(n,["presencePenalty"]);p!=null&&r(t,["presencePenalty"],p);const m=s(n,["frequencyPenalty"]);m!=null&&r(t,["frequencyPenalty"],m);const y=s(n,["seed"]);y!=null&&r(t,["seed"],y);const C=s(n,["responseMimeType"]);C!=null&&r(t,["responseMimeType"],C);const v=s(n,["responseSchema"]);if(v!=null&&r(t,["responseSchema"],Ct(o,ze(o,v))),s(n,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");const T=s(n,["safetySettings"]);e!==void 0&&T!=null&&(Array.isArray(T)?r(e,["safetySettings"],T.map(L=>Tt(o,L))):r(e,["safetySettings"],T));const _=s(n,["tools"]);e!==void 0&&_!=null&&(Array.isArray(_)?r(e,["tools"],U(o,U(o,_).map(L=>tn(o,be(o,L))))):r(e,["tools"],U(o,_)));const S=s(n,["toolConfig"]);if(e!==void 0&&S!=null&&r(e,["toolConfig"],Mt(o,S)),s(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const R=s(n,["cachedContent"]);e!==void 0&&R!=null&&r(e,["cachedContent"],D(o,R));const x=s(n,["responseModalities"]);x!=null&&r(t,["responseModalities"],x);const w=s(n,["mediaResolution"]);w!=null&&r(t,["mediaResolution"],w);const N=s(n,["speechConfig"]);if(N!=null&&r(t,["speechConfig"],Rt(o,Qe(o,N))),s(n,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const q=s(n,["thinkingConfig"]);return q!=null&&r(t,["thinkingConfig"],xt(o,q)),t}function Ue(o,n){const e={},t=s(n,["model"]);t!=null&&r(e,["_url","model"],M(o,t));const i=s(n,["contents"]);i!=null&&(Array.isArray(i)?r(e,["contents"],I(o,I(o,i).map(u=>k(o,u)))):r(e,["contents"],I(o,i)));const l=s(n,["config"]);return l!=null&&r(e,["generationConfig"],wt(o,l,e)),e}function Nt(o,n,e){const t={},i=s(n,["taskType"]);e!==void 0&&i!=null&&r(e,["requests[]","taskType"],i);const l=s(n,["title"]);e!==void 0&&l!=null&&r(e,["requests[]","title"],l);const u=s(n,["outputDimensionality"]);if(e!==void 0&&u!=null&&r(e,["requests[]","outputDimensionality"],u),s(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(s(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function Dt(o,n){const e={},t=s(n,["model"]);t!=null&&r(e,["_url","model"],M(o,t));const i=s(n,["contents"]);i!=null&&r(e,["requests[]","content"],Xe(o,i));const l=s(n,["config"]);l!=null&&r(e,["config"],Nt(o,l,e));const u=s(n,["model"]);return u!==void 0&&r(e,["requests[]","model"],M(o,u)),e}function Vt(o,n,e){const t={};if(s(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(s(n,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const i=s(n,["numberOfImages"]);e!==void 0&&i!=null&&r(e,["parameters","sampleCount"],i);const l=s(n,["aspectRatio"]);e!==void 0&&l!=null&&r(e,["parameters","aspectRatio"],l);const u=s(n,["guidanceScale"]);if(e!==void 0&&u!=null&&r(e,["parameters","guidanceScale"],u),s(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const a=s(n,["safetyFilterLevel"]);e!==void 0&&a!=null&&r(e,["parameters","safetySetting"],a);const c=s(n,["personGeneration"]);e!==void 0&&c!=null&&r(e,["parameters","personGeneration"],c);const f=s(n,["includeSafetyAttributes"]);e!==void 0&&f!=null&&r(e,["parameters","includeSafetyAttributes"],f);const d=s(n,["includeRaiReason"]);e!==void 0&&d!=null&&r(e,["parameters","includeRaiReason"],d);const h=s(n,["language"]);e!==void 0&&h!=null&&r(e,["parameters","language"],h);const g=s(n,["outputMimeType"]);e!==void 0&&g!=null&&r(e,["parameters","outputOptions","mimeType"],g);const p=s(n,["outputCompressionQuality"]);if(e!==void 0&&p!=null&&r(e,["parameters","outputOptions","compressionQuality"],p),s(n,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(s(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return t}function Ft(o,n){const e={},t=s(n,["model"]);t!=null&&r(e,["_url","model"],M(o,t));const i=s(n,["prompt"]);i!=null&&r(e,["instances[0]","prompt"],i);const l=s(n,["config"]);return l!=null&&r(e,["config"],Vt(o,l,e)),e}function Lt(o,n){const e={};if(s(n,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(s(n,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(s(n,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function Ut(o,n){const e={},t=s(n,["model"]);t!=null&&r(e,["_url","model"],M(o,t));const i=s(n,["contents"]);i!=null&&(Array.isArray(i)?r(e,["contents"],I(o,I(o,i).map(u=>k(o,u)))):r(e,["contents"],I(o,i)));const l=s(n,["config"]);return l!=null&&r(e,["config"],Lt(o,l)),e}function qt(o,n){const e={};if(s(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const t=s(n,["imageBytes"]);t!=null&&r(e,["bytesBase64Encoded"],V(o,t));const i=s(n,["mimeType"]);return i!=null&&r(e,["mimeType"],i),e}function Gt(o,n,e){const t={},i=s(n,["numberOfVideos"]);if(e!==void 0&&i!=null&&r(e,["parameters","sampleCount"],i),s(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(s(n,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const l=s(n,["durationSeconds"]);if(e!==void 0&&l!=null&&r(e,["parameters","durationSeconds"],l),s(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const u=s(n,["aspectRatio"]);if(e!==void 0&&u!=null&&r(e,["parameters","aspectRatio"],u),s(n,["resolution"])!==void 0)throw new Error("resolution parameter is not supported in Gemini API.");const a=s(n,["personGeneration"]);if(e!==void 0&&a!=null&&r(e,["parameters","personGeneration"],a),s(n,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const c=s(n,["negativePrompt"]);if(e!==void 0&&c!=null&&r(e,["parameters","negativePrompt"],c),s(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return t}function kt(o,n){const e={},t=s(n,["model"]);t!=null&&r(e,["_url","model"],M(o,t));const i=s(n,["prompt"]);i!=null&&r(e,["instances[0]","prompt"],i);const l=s(n,["image"]);l!=null&&r(e,["instances[0]","image"],qt(o,l));const u=s(n,["config"]);return u!=null&&r(e,["config"],Gt(o,u,e)),e}function Bt(o,n){const e={},t=s(n,["videoMetadata"]);t!=null&&r(e,["videoMetadata"],t);const i=s(n,["thought"]);i!=null&&r(e,["thought"],i);const l=s(n,["codeExecutionResult"]);l!=null&&r(e,["codeExecutionResult"],l);const u=s(n,["executableCode"]);u!=null&&r(e,["executableCode"],u);const a=s(n,["fileData"]);a!=null&&r(e,["fileData"],a);const c=s(n,["functionCall"]);c!=null&&r(e,["functionCall"],c);const f=s(n,["functionResponse"]);f!=null&&r(e,["functionResponse"],f);const d=s(n,["inlineData"]);d!=null&&r(e,["inlineData"],d);const h=s(n,["text"]);return h!=null&&r(e,["text"],h),e}function F(o,n){const e={},t=s(n,["parts"]);t!=null&&(Array.isArray(t)?r(e,["parts"],t.map(l=>Bt(o,l))):r(e,["parts"],t));const i=s(n,["role"]);return i!=null&&r(e,["role"],i),e}function on(o,n){const e={},t=s(n,["example"]);t!=null&&r(e,["example"],t);const i=s(n,["pattern"]);i!=null&&r(e,["pattern"],i);const l=s(n,["default"]);l!=null&&r(e,["default"],l);const u=s(n,["maxLength"]);u!=null&&r(e,["maxLength"],u);const a=s(n,["minLength"]);a!=null&&r(e,["minLength"],a);const c=s(n,["minProperties"]);c!=null&&r(e,["minProperties"],c);const f=s(n,["maxProperties"]);f!=null&&r(e,["maxProperties"],f);const d=s(n,["anyOf"]);d!=null&&r(e,["anyOf"],d);const h=s(n,["description"]);h!=null&&r(e,["description"],h);const g=s(n,["enum"]);g!=null&&r(e,["enum"],g);const p=s(n,["format"]);p!=null&&r(e,["format"],p);const m=s(n,["items"]);m!=null&&r(e,["items"],m);const y=s(n,["maxItems"]);y!=null&&r(e,["maxItems"],y);const C=s(n,["maximum"]);C!=null&&r(e,["maximum"],C);const v=s(n,["minItems"]);v!=null&&r(e,["minItems"],v);const T=s(n,["minimum"]);T!=null&&r(e,["minimum"],T);const _=s(n,["nullable"]);_!=null&&r(e,["nullable"],_);const S=s(n,["properties"]);S!=null&&r(e,["properties"],S);const R=s(n,["propertyOrdering"]);R!=null&&r(e,["propertyOrdering"],R);const x=s(n,["required"]);x!=null&&r(e,["required"],x);const w=s(n,["title"]);w!=null&&r(e,["title"],w);const N=s(n,["type"]);return N!=null&&r(e,["type"],N),e}function Ht(o,n){const e={},t=s(n,["method"]);t!=null&&r(e,["method"],t);const i=s(n,["category"]);i!=null&&r(e,["category"],i);const l=s(n,["threshold"]);return l!=null&&r(e,["threshold"],l),e}function Kt(o,n){const e={},t=s(n,["response"]);t!=null&&r(e,["response"],on(o,t));const i=s(n,["description"]);i!=null&&r(e,["description"],i);const l=s(n,["name"]);l!=null&&r(e,["name"],l);const u=s(n,["parameters"]);return u!=null&&r(e,["parameters"],u),e}function Ot(){return{}}function Yt(o,n){const e={},t=s(n,["mode"]);t!=null&&r(e,["mode"],t);const i=s(n,["dynamicThreshold"]);return i!=null&&r(e,["dynamicThreshold"],i),e}function $t(o,n){const e={},t=s(n,["dynamicRetrievalConfig"]);return t!=null&&r(e,["dynamicRetrievalConfig"],Yt(o,t)),e}function j(o,n){const e={},t=s(n,["functionDeclarations"]);t!=null&&(Array.isArray(t)?r(e,["functionDeclarations"],t.map(c=>Kt(o,c))):r(e,["functionDeclarations"],t));const i=s(n,["retrieval"]);i!=null&&r(e,["retrieval"],i),s(n,["googleSearch"])!=null&&r(e,["googleSearch"],Ot());const u=s(n,["googleSearchRetrieval"]);u!=null&&r(e,["googleSearchRetrieval"],$t(o,u));const a=s(n,["codeExecution"]);return a!=null&&r(e,["codeExecution"],a),e}function Jt(o,n){const e={},t=s(n,["mode"]);t!=null&&r(e,["mode"],t);const i=s(n,["allowedFunctionNames"]);return i!=null&&r(e,["allowedFunctionNames"],i),e}function Wt(o,n){const e={},t=s(n,["functionCallingConfig"]);return t!=null&&r(e,["functionCallingConfig"],Jt(o,t)),e}function Xt(o,n){const e={},t=s(n,["voiceName"]);return t!=null&&r(e,["voiceName"],t),e}function zt(o,n){const e={},t=s(n,["prebuiltVoiceConfig"]);return t!=null&&r(e,["prebuiltVoiceConfig"],Xt(o,t)),e}function Qt(o,n){const e={},t=s(n,["voiceConfig"]);return t!=null&&r(e,["voiceConfig"],zt(o,t)),e}function bt(o,n){const e={},t=s(n,["includeThoughts"]);return t!=null&&r(e,["includeThoughts"],t),e}function Zt(o,n,e){const t={},i=s(n,["systemInstruction"]);e!==void 0&&i!=null&&r(e,["systemInstruction"],F(o,P(o,i)));const l=s(n,["temperature"]);l!=null&&r(t,["temperature"],l);const u=s(n,["topP"]);u!=null&&r(t,["topP"],u);const a=s(n,["topK"]);a!=null&&r(t,["topK"],a);const c=s(n,["candidateCount"]);c!=null&&r(t,["candidateCount"],c);const f=s(n,["maxOutputTokens"]);f!=null&&r(t,["maxOutputTokens"],f);const d=s(n,["stopSequences"]);d!=null&&r(t,["stopSequences"],d);const h=s(n,["responseLogprobs"]);h!=null&&r(t,["responseLogprobs"],h);const g=s(n,["logprobs"]);g!=null&&r(t,["logprobs"],g);const p=s(n,["presencePenalty"]);p!=null&&r(t,["presencePenalty"],p);const m=s(n,["frequencyPenalty"]);m!=null&&r(t,["frequencyPenalty"],m);const y=s(n,["seed"]);y!=null&&r(t,["seed"],y);const C=s(n,["responseMimeType"]);C!=null&&r(t,["responseMimeType"],C);const v=s(n,["responseSchema"]);v!=null&&r(t,["responseSchema"],on(o,ze(o,v)));const T=s(n,["routingConfig"]);T!=null&&r(t,["routingConfig"],T);const _=s(n,["safetySettings"]);e!==void 0&&_!=null&&(Array.isArray(_)?r(e,["safetySettings"],_.map(X=>Ht(o,X))):r(e,["safetySettings"],_));const S=s(n,["tools"]);e!==void 0&&S!=null&&(Array.isArray(S)?r(e,["tools"],U(o,U(o,S).map(X=>j(o,be(o,X))))):r(e,["tools"],U(o,S)));const R=s(n,["toolConfig"]);e!==void 0&&R!=null&&r(e,["toolConfig"],Wt(o,R));const x=s(n,["labels"]);e!==void 0&&x!=null&&r(e,["labels"],x);const w=s(n,["cachedContent"]);e!==void 0&&w!=null&&r(e,["cachedContent"],D(o,w));const N=s(n,["responseModalities"]);N!=null&&r(t,["responseModalities"],N);const q=s(n,["mediaResolution"]);q!=null&&r(t,["mediaResolution"],q);const L=s(n,["speechConfig"]);L!=null&&r(t,["speechConfig"],Qt(o,Qe(o,L)));const ee=s(n,["audioTimestamp"]);ee!=null&&r(t,["audioTimestamp"],ee);const ne=s(n,["thinkingConfig"]);return ne!=null&&r(t,["thinkingConfig"],bt(o,ne)),t}function qe(o,n){const e={},t=s(n,["model"]);t!=null&&r(e,["_url","model"],M(o,t));const i=s(n,["contents"]);i!=null&&(Array.isArray(i)?r(e,["contents"],I(o,I(o,i).map(u=>F(o,u)))):r(e,["contents"],I(o,i)));const l=s(n,["config"]);return l!=null&&r(e,["generationConfig"],Zt(o,l,e)),e}function jt(o,n,e){const t={},i=s(n,["taskType"]);e!==void 0&&i!=null&&r(e,["instances[]","task_type"],i);const l=s(n,["title"]);e!==void 0&&l!=null&&r(e,["instances[]","title"],l);const u=s(n,["outputDimensionality"]);e!==void 0&&u!=null&&r(e,["parameters","outputDimensionality"],u);const a=s(n,["mimeType"]);e!==void 0&&a!=null&&r(e,["instances[]","mimeType"],a);const c=s(n,["autoTruncate"]);return e!==void 0&&c!=null&&r(e,["parameters","autoTruncate"],c),t}function eo(o,n){const e={},t=s(n,["model"]);t!=null&&r(e,["_url","model"],M(o,t));const i=s(n,["contents"]);i!=null&&r(e,["instances[]","content"],Xe(o,i));const l=s(n,["config"]);return l!=null&&r(e,["config"],jt(o,l,e)),e}function no(o,n,e){const t={},i=s(n,["outputGcsUri"]);e!==void 0&&i!=null&&r(e,["parameters","storageUri"],i);const l=s(n,["negativePrompt"]);e!==void 0&&l!=null&&r(e,["parameters","negativePrompt"],l);const u=s(n,["numberOfImages"]);e!==void 0&&u!=null&&r(e,["parameters","sampleCount"],u);const a=s(n,["aspectRatio"]);e!==void 0&&a!=null&&r(e,["parameters","aspectRatio"],a);const c=s(n,["guidanceScale"]);e!==void 0&&c!=null&&r(e,["parameters","guidanceScale"],c);const f=s(n,["seed"]);e!==void 0&&f!=null&&r(e,["parameters","seed"],f);const d=s(n,["safetyFilterLevel"]);e!==void 0&&d!=null&&r(e,["parameters","safetySetting"],d);const h=s(n,["personGeneration"]);e!==void 0&&h!=null&&r(e,["parameters","personGeneration"],h);const g=s(n,["includeSafetyAttributes"]);e!==void 0&&g!=null&&r(e,["parameters","includeSafetyAttributes"],g);const p=s(n,["includeRaiReason"]);e!==void 0&&p!=null&&r(e,["parameters","includeRaiReason"],p);const m=s(n,["language"]);e!==void 0&&m!=null&&r(e,["parameters","language"],m);const y=s(n,["outputMimeType"]);e!==void 0&&y!=null&&r(e,["parameters","outputOptions","mimeType"],y);const C=s(n,["outputCompressionQuality"]);e!==void 0&&C!=null&&r(e,["parameters","outputOptions","compressionQuality"],C);const v=s(n,["addWatermark"]);e!==void 0&&v!=null&&r(e,["parameters","addWatermark"],v);const T=s(n,["enhancePrompt"]);return e!==void 0&&T!=null&&r(e,["parameters","enhancePrompt"],T),t}function to(o,n){const e={},t=s(n,["model"]);t!=null&&r(e,["_url","model"],M(o,t));const i=s(n,["prompt"]);i!=null&&r(e,["instances[0]","prompt"],i);const l=s(n,["config"]);return l!=null&&r(e,["config"],no(o,l,e)),e}function oo(o,n,e){const t={},i=s(n,["systemInstruction"]);e!==void 0&&i!=null&&r(e,["systemInstruction"],F(o,P(o,i)));const l=s(n,["tools"]);e!==void 0&&l!=null&&(Array.isArray(l)?r(e,["tools"],l.map(a=>j(o,a))):r(e,["tools"],l));const u=s(n,["generationConfig"]);return e!==void 0&&u!=null&&r(e,["generationConfig"],u),t}function io(o,n){const e={},t=s(n,["model"]);t!=null&&r(e,["_url","model"],M(o,t));const i=s(n,["contents"]);i!=null&&(Array.isArray(i)?r(e,["contents"],I(o,I(o,i).map(u=>F(o,u)))):r(e,["contents"],I(o,i)));const l=s(n,["config"]);return l!=null&&r(e,["config"],oo(o,l,e)),e}function ro(o,n){const e={},t=s(n,["model"]);t!=null&&r(e,["_url","model"],M(o,t));const i=s(n,["contents"]);i!=null&&(Array.isArray(i)?r(e,["contents"],I(o,I(o,i).map(u=>F(o,u)))):r(e,["contents"],I(o,i)));const l=s(n,["config"]);return l!=null&&r(e,["config"],l),e}function so(o,n){const e={},t=s(n,["gcsUri"]);t!=null&&r(e,["gcsUri"],t);const i=s(n,["imageBytes"]);i!=null&&r(e,["bytesBase64Encoded"],V(o,i));const l=s(n,["mimeType"]);return l!=null&&r(e,["mimeType"],l),e}function lo(o,n,e){const t={},i=s(n,["numberOfVideos"]);e!==void 0&&i!=null&&r(e,["parameters","sampleCount"],i);const l=s(n,["outputGcsUri"]);e!==void 0&&l!=null&&r(e,["parameters","storageUri"],l);const u=s(n,["fps"]);e!==void 0&&u!=null&&r(e,["parameters","fps"],u);const a=s(n,["durationSeconds"]);e!==void 0&&a!=null&&r(e,["parameters","durationSeconds"],a);const c=s(n,["seed"]);e!==void 0&&c!=null&&r(e,["parameters","seed"],c);const f=s(n,["aspectRatio"]);e!==void 0&&f!=null&&r(e,["parameters","aspectRatio"],f);const d=s(n,["resolution"]);e!==void 0&&d!=null&&r(e,["parameters","resolution"],d);const h=s(n,["personGeneration"]);e!==void 0&&h!=null&&r(e,["parameters","personGeneration"],h);const g=s(n,["pubsubTopic"]);e!==void 0&&g!=null&&r(e,["parameters","pubsubTopic"],g);const p=s(n,["negativePrompt"]);e!==void 0&&p!=null&&r(e,["parameters","negativePrompt"],p);const m=s(n,["enhancePrompt"]);return e!==void 0&&m!=null&&r(e,["parameters","enhancePrompt"],m),t}function ao(o,n){const e={},t=s(n,["model"]);t!=null&&r(e,["_url","model"],M(o,t));const i=s(n,["prompt"]);i!=null&&r(e,["instances[0]","prompt"],i);const l=s(n,["image"]);l!=null&&r(e,["instances[0]","image"],so(o,l));const u=s(n,["config"]);return u!=null&&r(e,["config"],lo(o,u,e)),e}function uo(o,n){const e={},t=s(n,["thought"]);t!=null&&r(e,["thought"],t);const i=s(n,["codeExecutionResult"]);i!=null&&r(e,["codeExecutionResult"],i);const l=s(n,["executableCode"]);l!=null&&r(e,["executableCode"],l);const u=s(n,["fileData"]);u!=null&&r(e,["fileData"],u);const a=s(n,["functionCall"]);a!=null&&r(e,["functionCall"],a);const c=s(n,["functionResponse"]);c!=null&&r(e,["functionResponse"],c);const f=s(n,["inlineData"]);f!=null&&r(e,["inlineData"],f);const d=s(n,["text"]);return d!=null&&r(e,["text"],d),e}function rn(o,n){const e={},t=s(n,["parts"]);t!=null&&(Array.isArray(t)?r(e,["parts"],t.map(l=>uo(o,l))):r(e,["parts"],t));const i=s(n,["role"]);return i!=null&&r(e,["role"],i),e}function co(o,n){const e={},t=s(n,["citationSources"]);return t!=null&&r(e,["citations"],t),e}function fo(o,n){const e={},t=s(n,["content"]);t!=null&&r(e,["content"],rn(o,t));const i=s(n,["citationMetadata"]);i!=null&&r(e,["citationMetadata"],co(o,i));const l=s(n,["tokenCount"]);l!=null&&r(e,["tokenCount"],l);const u=s(n,["finishReason"]);u!=null&&r(e,["finishReason"],u);const a=s(n,["avgLogprobs"]);a!=null&&r(e,["avgLogprobs"],a);const c=s(n,["groundingMetadata"]);c!=null&&r(e,["groundingMetadata"],c);const f=s(n,["index"]);f!=null&&r(e,["index"],f);const d=s(n,["logprobsResult"]);d!=null&&r(e,["logprobsResult"],d);const h=s(n,["safetyRatings"]);return h!=null&&r(e,["safetyRatings"],h),e}function Ge(o,n){const e={},t=s(n,["candidates"]);t!=null&&(Array.isArray(t)?r(e,["candidates"],t.map(a=>fo(o,a))):r(e,["candidates"],t));const i=s(n,["modelVersion"]);i!=null&&r(e,["modelVersion"],i);const l=s(n,["promptFeedback"]);l!=null&&r(e,["promptFeedback"],l);const u=s(n,["usageMetadata"]);return u!=null&&r(e,["usageMetadata"],u),e}function ho(o,n){const e={},t=s(n,["values"]);return t!=null&&r(e,["values"],t),e}function po(){return{}}function mo(o,n){const e={},t=s(n,["embeddings"]);return t!=null&&(Array.isArray(t)?r(e,["embeddings"],t.map(l=>ho(o,l))):r(e,["embeddings"],t)),s(n,["metadata"])!=null&&r(e,["metadata"],po()),e}function go(o,n){const e={},t=s(n,["bytesBase64Encoded"]);t!=null&&r(e,["imageBytes"],V(o,t));const i=s(n,["mimeType"]);return i!=null&&r(e,["mimeType"],i),e}function sn(o,n){const e={},t=s(n,["safetyAttributes","categories"]);t!=null&&r(e,["categories"],t);const i=s(n,["safetyAttributes","scores"]);i!=null&&r(e,["scores"],i);const l=s(n,["contentType"]);return l!=null&&r(e,["contentType"],l),e}function yo(o,n){const e={},t=s(n,["_self"]);t!=null&&r(e,["image"],go(o,t));const i=s(n,["raiFilteredReason"]);i!=null&&r(e,["raiFilteredReason"],i);const l=s(n,["_self"]);return l!=null&&r(e,["safetyAttributes"],sn(o,l)),e}function Co(o,n){const e={},t=s(n,["predictions"]);t!=null&&(Array.isArray(t)?r(e,["generatedImages"],t.map(l=>yo(o,l))):r(e,["generatedImages"],t));const i=s(n,["positivePromptSafetyAttributes"]);return i!=null&&r(e,["positivePromptSafetyAttributes"],sn(o,i)),e}function To(o,n){const e={},t=s(n,["totalTokens"]);t!=null&&r(e,["totalTokens"],t);const i=s(n,["cachedContentTokenCount"]);return i!=null&&r(e,["cachedContentTokenCount"],i),e}function Eo(o,n){const e={},t=s(n,["video","uri"]);t!=null&&r(e,["uri"],t);const i=s(n,["video","encodedVideo"]);i!=null&&r(e,["videoBytes"],V(o,i));const l=s(n,["encoding"]);return l!=null&&r(e,["mimeType"],l),e}function vo(o,n){const e={},t=s(n,["_self"]);return t!=null&&r(e,["video"],Eo(o,t)),e}function _o(o,n){const e={},t=s(n,["generatedSamples"]);t!=null&&(Array.isArray(t)?r(e,["generatedVideos"],t.map(u=>vo(o,u))):r(e,["generatedVideos"],t));const i=s(n,["raiMediaFilteredCount"]);i!=null&&r(e,["raiMediaFilteredCount"],i);const l=s(n,["raiMediaFilteredReasons"]);return l!=null&&r(e,["raiMediaFilteredReasons"],l),e}function Io(o,n){const e={},t=s(n,["name"]);t!=null&&r(e,["name"],t);const i=s(n,["metadata"]);i!=null&&r(e,["metadata"],i);const l=s(n,["done"]);l!=null&&r(e,["done"],l);const u=s(n,["error"]);u!=null&&r(e,["error"],u);const a=s(n,["response"]);a!=null&&r(e,["response"],a);const c=s(n,["response","generateVideoResponse"]);return c!=null&&r(e,["result"],_o(o,c)),e}function Ao(o,n){const e={},t=s(n,["videoMetadata"]);t!=null&&r(e,["videoMetadata"],t);const i=s(n,["thought"]);i!=null&&r(e,["thought"],i);const l=s(n,["codeExecutionResult"]);l!=null&&r(e,["codeExecutionResult"],l);const u=s(n,["executableCode"]);u!=null&&r(e,["executableCode"],u);const a=s(n,["fileData"]);a!=null&&r(e,["fileData"],a);const c=s(n,["functionCall"]);c!=null&&r(e,["functionCall"],c);const f=s(n,["functionResponse"]);f!=null&&r(e,["functionResponse"],f);const d=s(n,["inlineData"]);d!=null&&r(e,["inlineData"],d);const h=s(n,["text"]);return h!=null&&r(e,["text"],h),e}function ln(o,n){const e={},t=s(n,["parts"]);t!=null&&(Array.isArray(t)?r(e,["parts"],t.map(l=>Ao(o,l))):r(e,["parts"],t));const i=s(n,["role"]);return i!=null&&r(e,["role"],i),e}function Mo(o,n){const e={},t=s(n,["citations"]);return t!=null&&r(e,["citations"],t),e}function So(o,n){const e={},t=s(n,["content"]);t!=null&&r(e,["content"],ln(o,t));const i=s(n,["citationMetadata"]);i!=null&&r(e,["citationMetadata"],Mo(o,i));const l=s(n,["finishMessage"]);l!=null&&r(e,["finishMessage"],l);const u=s(n,["finishReason"]);u!=null&&r(e,["finishReason"],u);const a=s(n,["avgLogprobs"]);a!=null&&r(e,["avgLogprobs"],a);const c=s(n,["groundingMetadata"]);c!=null&&r(e,["groundingMetadata"],c);const f=s(n,["index"]);f!=null&&r(e,["index"],f);const d=s(n,["logprobsResult"]);d!=null&&r(e,["logprobsResult"],d);const h=s(n,["safetyRatings"]);return h!=null&&r(e,["safetyRatings"],h),e}function ke(o,n){const e={},t=s(n,["candidates"]);t!=null&&(Array.isArray(t)?r(e,["candidates"],t.map(f=>So(o,f))):r(e,["candidates"],t));const i=s(n,["createTime"]);i!=null&&r(e,["createTime"],i);const l=s(n,["responseId"]);l!=null&&r(e,["responseId"],l);const u=s(n,["modelVersion"]);u!=null&&r(e,["modelVersion"],u);const a=s(n,["promptFeedback"]);a!=null&&r(e,["promptFeedback"],a);const c=s(n,["usageMetadata"]);return c!=null&&r(e,["usageMetadata"],c),e}function Po(o,n){const e={},t=s(n,["truncated"]);t!=null&&r(e,["truncated"],t);const i=s(n,["token_count"]);return i!=null&&r(e,["tokenCount"],i),e}function Ro(o,n){const e={},t=s(n,["values"]);t!=null&&r(e,["values"],t);const i=s(n,["statistics"]);return i!=null&&r(e,["statistics"],Po(o,i)),e}function xo(o,n){const e={},t=s(n,["billableCharacterCount"]);return t!=null&&r(e,["billableCharacterCount"],t),e}function wo(o,n){const e={},t=s(n,["predictions[]","embeddings"]);t!=null&&(Array.isArray(t)?r(e,["embeddings"],t.map(l=>Ro(o,l))):r(e,["embeddings"],t));const i=s(n,["metadata"]);return i!=null&&r(e,["metadata"],xo(o,i)),e}function No(o,n){const e={},t=s(n,["gcsUri"]);t!=null&&r(e,["gcsUri"],t);const i=s(n,["bytesBase64Encoded"]);i!=null&&r(e,["imageBytes"],V(o,i));const l=s(n,["mimeType"]);return l!=null&&r(e,["mimeType"],l),e}function an(o,n){const e={},t=s(n,["safetyAttributes","categories"]);t!=null&&r(e,["categories"],t);const i=s(n,["safetyAttributes","scores"]);i!=null&&r(e,["scores"],i);const l=s(n,["contentType"]);return l!=null&&r(e,["contentType"],l),e}function Do(o,n){const e={},t=s(n,["_self"]);t!=null&&r(e,["image"],No(o,t));const i=s(n,["raiFilteredReason"]);i!=null&&r(e,["raiFilteredReason"],i);const l=s(n,["_self"]);l!=null&&r(e,["safetyAttributes"],an(o,l));const u=s(n,["prompt"]);return u!=null&&r(e,["enhancedPrompt"],u),e}function Vo(o,n){const e={},t=s(n,["predictions"]);t!=null&&(Array.isArray(t)?r(e,["generatedImages"],t.map(l=>Do(o,l))):r(e,["generatedImages"],t));const i=s(n,["positivePromptSafetyAttributes"]);return i!=null&&r(e,["positivePromptSafetyAttributes"],an(o,i)),e}function Fo(o,n){const e={},t=s(n,["totalTokens"]);return t!=null&&r(e,["totalTokens"],t),e}function Lo(o,n){const e={},t=s(n,["tokensInfo"]);return t!=null&&r(e,["tokensInfo"],t),e}function Uo(o,n){const e={},t=s(n,["gcsUri"]);t!=null&&r(e,["uri"],t);const i=s(n,["bytesBase64Encoded"]);i!=null&&r(e,["videoBytes"],V(o,i));const l=s(n,["mimeType"]);return l!=null&&r(e,["mimeType"],l),e}function qo(o,n){const e={},t=s(n,["_self"]);return t!=null&&r(e,["video"],Uo(o,t)),e}function Go(o,n){const e={},t=s(n,["videos"]);t!=null&&(Array.isArray(t)?r(e,["generatedVideos"],t.map(u=>qo(o,u))):r(e,["generatedVideos"],t));const i=s(n,["raiMediaFilteredCount"]);i!=null&&r(e,["raiMediaFilteredCount"],i);const l=s(n,["raiMediaFilteredReasons"]);return l!=null&&r(e,["raiMediaFilteredReasons"],l),e}function ko(o,n){const e={},t=s(n,["name"]);t!=null&&r(e,["name"],t);const i=s(n,["metadata"]);i!=null&&r(e,["metadata"],i);const l=s(n,["done"]);l!=null&&r(e,["done"],l);const u=s(n,["error"]);u!=null&&r(e,["error"],u);const a=s(n,["response"]);a!=null&&r(e,["response"],a);const c=s(n,["response"]);return c!=null&&r(e,["result"],Go(o,c)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Bo(o,n){const e={},t=s(n,["config"]);t!=null&&r(e,["setup"],Yo(o,t));const i=s(n,["model"]);return i!==void 0&&r(e,["setup","model"],i),e}function Ho(o,n){const e={},t=s(n,["config"]);t!=null&&r(e,["setup"],$o(o,t));const i=s(n,["model"]);return i!==void 0&&r(e,["setup","model"],i),e}function Ko(o,n){const e={},t=s(n,["setupComplete"]);t!==void 0&&r(e,["setupComplete"],t);const i=s(n,["serverContent"]);i!=null&&r(e,["serverContent"],Jo(o,i));const l=s(n,["toolCall"]);l!=null&&r(e,["toolCall"],Qo(o,l));const u=s(n,["toolCallCancellation"]);return u!=null&&r(e,["toolCallCancellation"],Zo(o,u)),e}function Oo(o,n){const e={},t=s(n,["setupComplete"]);t!==void 0&&r(e,["setupComplete"],t);const i=s(n,["serverContent"]);i!=null&&r(e,["serverContent"],Wo(o,i));const l=s(n,["toolCall"]);l!=null&&r(e,["toolCall"],bo(o,l));const u=s(n,["toolCallCancellation"]);return u!=null&&r(e,["toolCallCancellation"],jo(o,u)),e}function Yo(o,n){const e={},t=s(n,["generationConfig"]);t!==void 0&&r(e,["generationConfig"],t);const i=s(n,["responseModalities"]);i!==void 0&&r(e,["generationConfig","responseModalities"],i);const l=s(n,["speechConfig"]);l!==void 0&&r(e,["generationConfig","speechConfig"],l);const u=s(n,["systemInstruction"]);u!=null&&r(e,["systemInstruction"],k(o,u));const a=s(n,["tools"]);return a!=null&&Array.isArray(a)&&r(e,["tools"],a.map(c=>tn(o,c))),e}function $o(o,n){const e={},t=s(n,["generationConfig"]);t!==void 0&&r(e,["generationConfig"],t);const i=s(n,["responseModalities"]);i!==void 0?r(e,["generationConfig","responseModalities"],i):r(e,["generationConfig","responseModalities"],["AUDIO"]);const l=s(n,["speechConfig"]);l!==void 0&&r(e,["generationConfig","speechConfig"],l);const u=s(n,["systemInstruction"]);u!=null&&r(e,["systemInstruction"],F(o,u));const a=s(n,["tools"]);return a!=null&&Array.isArray(a)&&r(e,["tools"],a.map(c=>j(o,c))),e}function Jo(o,n){const e={},t=s(n,["modelTurn"]);t!=null&&r(e,["modelTurn"],rn(o,t));const i=s(n,["turnComplete"]);i!==void 0&&r(e,["turnComplete"],i);const l=s(n,["interrupted"]);return l!==void 0&&r(e,["interrupted"],l),e}function Wo(o,n){const e={},t=s(n,["modelTurn"]);t!=null&&r(e,["modelTurn"],ln(o,t));const i=s(n,["turnComplete"]);i!==void 0&&r(e,["turnComplete"],i);const l=s(n,["interrupted"]);return l!==void 0&&r(e,["interrupted"],l),e}function Xo(o,n){const e={},t=s(n,["id"]);t!==void 0&&r(e,["id"],t);const i=s(n,["args"]);i!==void 0&&r(e,["args"],i);const l=s(n,["name"]);return l!==void 0&&r(e,["name"],l),e}function zo(o,n){const e={},t=s(n,["args"]);t!==void 0&&r(e,["args"],t);const i=s(n,["name"]);return i!==void 0&&r(e,["name"],i),e}function Qo(o,n){const e={},t=s(n,["functionCalls"]);return t!=null&&Array.isArray(t)&&r(e,["functionCalls"],t.map(i=>Xo(o,i))),e}function bo(o,n){const e={},t=s(n,["functionCalls"]);return t!=null&&Array.isArray(t)&&r(e,["functionCalls"],t.map(i=>zo(o,i))),e}function Zo(o,n){const e={},t=s(n,["ids"]);return t!==void 0&&r(e,["ids"],t),e}function jo(o,n){const e={},t=s(n,["ids"]);return t!==void 0&&r(e,["ids"],t),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const ei="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function ni(o,n,e){let t,i;e.data instanceof Blob?i=JSON.parse(await e.data.text()):i=JSON.parse(e.data),o.isVertexAI()?t=Oo(o,i):t=Ko(o,i),n(t)}class ti{constructor(n,e,t){this.apiClient=n,this.auth=e,this.webSocketFactory=t}async connect(n){var e,t;const i=this.apiClient.getWebsocketBaseUrl(),l=this.apiClient.getApiVersion();let u;const a=si(this.apiClient.getDefaultHeaders());if(this.apiClient.isVertexAI())u=`${i}/ws/google.cloud.aiplatform.${l}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(a);else{const T=this.apiClient.getApiKey();u=`${i}/ws/google.ai.generativelanguage.${l}.GenerativeService.BidiGenerateContent?key=${T}`}let c=()=>{};const f=new Promise(T=>{c=T}),d=n.callbacks,h=function(){var T;(T=d==null?void 0:d.onopen)===null||T===void 0||T.call(d),c({})},g=this.apiClient,p={onopen:h,onmessage:T=>{ni(g,d.onmessage,T)},onerror:(e=d==null?void 0:d.onerror)!==null&&e!==void 0?e:function(T){},onclose:(t=d==null?void 0:d.onclose)!==null&&t!==void 0?t:function(T){}},m=this.webSocketFactory.create(u,ri(a),p);m.connect(),await f;let y=M(this.apiClient,n.model);if(this.apiClient.isVertexAI()&&y.startsWith("publishers/")){const T=this.apiClient.getProject(),_=this.apiClient.getLocation();y=`projects/${T}/locations/${_}/`+y}let C={};const v={model:y,config:n.config,callbacks:n.callbacks};return this.apiClient.isVertexAI()?C=Ho(this.apiClient,v):C=Bo(this.apiClient,v),m.send(JSON.stringify(C)),new ii(m,this.apiClient)}}const oi={turnComplete:!0};class ii{constructor(n,e){this.conn=n,this.apiClient=e}tLiveClientContent(n,e){if(e.turns!==null&&e.turns!==void 0){let t=[];try{t=I(n,e.turns),n.isVertexAI()?t=t.map(i=>F(n,i)):t=t.map(i=>k(n,i))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof e.turns}'`)}return{clientContent:{turns:t,turnComplete:e.turnComplete}}}return{clientContent:{turnComplete:e.turnComplete}}}tLiveClientRealtimeInput(n,e){let t={};if(!("media"in e)||!e.media)throw new Error(`Failed to convert realtime input "media", type: '${typeof e.media}'`);return t={realtimeInput:{mediaChunks:[e.media]}},t}tLiveClienttToolResponse(n,e){let t=[];if(e.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(e.functionResponses)?t=e.functionResponses:t=[e.functionResponses],t.length===0)throw new Error("functionResponses is required.");for(const l of t){if(typeof l!="object"||l===null||!("name"in l)||!("response"in l))throw new Error(`Could not parse function response, type '${typeof l}'.`);if(!n.isVertexAI()&&!("id"in l))throw new Error(ei)}return{toolResponse:{functionResponses:t}}}sendClientContent(n){n=Object.assign(Object.assign({},oi),n);const e=this.tLiveClientContent(this.apiClient,n);this.conn.send(JSON.stringify(e))}sendRealtimeInput(n){if(n.media==null)throw new Error("Media is required.");const e=this.tLiveClientRealtimeInput(this.apiClient,n);this.conn.send(JSON.stringify(e))}sendToolResponse(n){if(n.functionResponses==null)throw new Error("Tool response parameters are required.");const e=this.tLiveClienttToolResponse(this.apiClient,n);this.conn.send(JSON.stringify(e))}close(){this.conn.close()}}function ri(o){const n={};return o.forEach((e,t)=>{n[t]=e}),n}function si(o){const n=new Headers;for(const[e,t]of Object.entries(o))n.append(e,t);return n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class li extends W{constructor(n){super(),this.apiClient=n,this.generateContent=async e=>await this.generateContentInternal(e),this.generateContentStream=async e=>await this.generateContentStreamInternal(e),this.generateImages=async e=>await this.generateImagesInternal(e).then(t=>{var i;let l;const u=[];if(t!=null&&t.generatedImages)for(const c of t.generatedImages)c&&(c!=null&&c.safetyAttributes)&&((i=c==null?void 0:c.safetyAttributes)===null||i===void 0?void 0:i.contentType)==="Positive Prompt"?l=c==null?void 0:c.safetyAttributes:u.push(c);let a;return l?a={generatedImages:u,positivePromptSafetyAttributes:l}:a={generatedImages:u},a})}async generateContentInternal(n){var e,t;let i,l="",u={};if(this.apiClient.isVertexAI()){const a=qe(this.apiClient,n);return l=E("{model}:generateContent",a._url),u=a._query,delete a.config,delete a._url,delete a._query,i=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(e=n.config)===null||e===void 0?void 0:e.httpOptions}).then(c=>c.json()),i.then(c=>{const f=ke(this.apiClient,c),d=new B;return Object.assign(d,f),d})}else{const a=Ue(this.apiClient,n);return l=E("{model}:generateContent",a._url),u=a._query,delete a.config,delete a._url,delete a._query,i=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions}).then(c=>c.json()),i.then(c=>{const f=Ge(this.apiClient,c),d=new B;return Object.assign(d,f),d})}}async generateContentStreamInternal(n){var e,t;let i,l="",u={};if(this.apiClient.isVertexAI()){const a=qe(this.apiClient,n);l=E("{model}:streamGenerateContent?alt=sse",a._url),u=a._query,delete a.config,delete a._url,delete a._query;const c=this.apiClient;return i=c.requestStream({path:l,queryParams:u,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(e=n.config)===null||e===void 0?void 0:e.httpOptions}),i.then(function(f){return J(this,arguments,function*(){var d,h,g,p;try{for(var m=!0,y=Q(f),C;C=yield A(y.next()),d=C.done,!d;m=!0){p=C.value,m=!1;const T=ke(c,p),_=new B;Object.assign(_,T),yield yield A(_)}}catch(v){h={error:v}}finally{try{!m&&!d&&(g=y.return)&&(yield A(g.call(y)))}finally{if(h)throw h.error}}})})}else{const a=Ue(this.apiClient,n);l=E("{model}:streamGenerateContent?alt=sse",a._url),u=a._query,delete a.config,delete a._url,delete a._query;const c=this.apiClient;return i=c.requestStream({path:l,queryParams:u,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions}),i.then(function(f){return J(this,arguments,function*(){var d,h,g,p;try{for(var m=!0,y=Q(f),C;C=yield A(y.next()),d=C.done,!d;m=!0){p=C.value,m=!1;const T=Ge(c,p),_=new B;Object.assign(_,T),yield yield A(_)}}catch(v){h={error:v}}finally{try{!m&&!d&&(g=y.return)&&(yield A(g.call(y)))}finally{if(h)throw h.error}}})})}}async embedContent(n){var e,t;let i,l="",u={};if(this.apiClient.isVertexAI()){const a=eo(this.apiClient,n);return l=E("{model}:predict",a._url),u=a._query,delete a.config,delete a._url,delete a._query,i=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(e=n.config)===null||e===void 0?void 0:e.httpOptions}).then(c=>c.json()),i.then(c=>{const f=wo(this.apiClient,c),d=new we;return Object.assign(d,f),d})}else{const a=Dt(this.apiClient,n);return l=E("{model}:batchEmbedContents",a._url),u=a._query,delete a.config,delete a._url,delete a._query,i=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions}).then(c=>c.json()),i.then(c=>{const f=mo(this.apiClient,c),d=new we;return Object.assign(d,f),d})}}async generateImagesInternal(n){var e,t;let i,l="",u={};if(this.apiClient.isVertexAI()){const a=to(this.apiClient,n);return l=E("{model}:predict",a._url),u=a._query,delete a.config,delete a._url,delete a._query,i=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(e=n.config)===null||e===void 0?void 0:e.httpOptions}).then(c=>c.json()),i.then(c=>{const f=Vo(this.apiClient,c),d=new Ne;return Object.assign(d,f),d})}else{const a=Ft(this.apiClient,n);return l=E("{model}:predict",a._url),u=a._query,delete a.config,delete a._url,delete a._query,i=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions}).then(c=>c.json()),i.then(c=>{const f=Co(this.apiClient,c),d=new Ne;return Object.assign(d,f),d})}}async countTokens(n){var e,t;let i,l="",u={};if(this.apiClient.isVertexAI()){const a=io(this.apiClient,n);return l=E("{model}:countTokens",a._url),u=a._query,delete a.config,delete a._url,delete a._query,i=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(e=n.config)===null||e===void 0?void 0:e.httpOptions}).then(c=>c.json()),i.then(c=>{const f=Fo(this.apiClient,c),d=new De;return Object.assign(d,f),d})}else{const a=Ut(this.apiClient,n);return l=E("{model}:countTokens",a._url),u=a._query,delete a.config,delete a._url,delete a._query,i=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions}).then(c=>c.json()),i.then(c=>{const f=To(this.apiClient,c),d=new De;return Object.assign(d,f),d})}}async computeTokens(n){var e;let t,i="",l={};if(this.apiClient.isVertexAI()){const u=ro(this.apiClient,n);return i=E("{model}:computeTokens",u._url),l=u._query,delete u.config,delete u._url,delete u._query,t=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(e=n.config)===null||e===void 0?void 0:e.httpOptions}).then(a=>a.json()),t.then(a=>{const c=Lo(this.apiClient,a),f=new zn;return Object.assign(f,c),f})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideos(n){var e,t;let i,l="",u={};if(this.apiClient.isVertexAI()){const a=ao(this.apiClient,n);return l=E("{model}:predictLongRunning",a._url),u=a._query,delete a.config,delete a._url,delete a._query,i=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(e=n.config)===null||e===void 0?void 0:e.httpOptions}).then(c=>c.json()),i.then(c=>ko(this.apiClient,c))}else{const a=kt(this.apiClient,n);return l=E("{model}:predictLongRunning",a._url),u=a._query,delete a.config,delete a._url,delete a._query,i=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions}).then(c=>c.json()),i.then(c=>Io(this.apiClient,c))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ai(o,n){const e={},t=s(n,["operationName"]);t!=null&&r(e,["_url","operationName"],t);const i=s(n,["config"]);return i!=null&&r(e,["config"],i),e}function ui(o,n){const e={},t=s(n,["operationName"]);t!=null&&r(e,["_url","operationName"],t);const i=s(n,["config"]);return i!=null&&r(e,["config"],i),e}function ci(o,n){const e={},t=s(n,["operationName"]);t!=null&&r(e,["operationName"],t);const i=s(n,["resourceName"]);i!=null&&r(e,["_url","resourceName"],i);const l=s(n,["config"]);return l!=null&&r(e,["config"],l),e}function fi(o,n){const e={},t=s(n,["video","uri"]);t!=null&&r(e,["uri"],t);const i=s(n,["video","encodedVideo"]);i!=null&&r(e,["videoBytes"],V(o,i));const l=s(n,["encoding"]);return l!=null&&r(e,["mimeType"],l),e}function di(o,n){const e={},t=s(n,["_self"]);return t!=null&&r(e,["video"],fi(o,t)),e}function hi(o,n){const e={},t=s(n,["generatedSamples"]);t!=null&&(Array.isArray(t)?r(e,["generatedVideos"],t.map(u=>di(o,u))):r(e,["generatedVideos"],t));const i=s(n,["raiMediaFilteredCount"]);i!=null&&r(e,["raiMediaFilteredCount"],i);const l=s(n,["raiMediaFilteredReasons"]);return l!=null&&r(e,["raiMediaFilteredReasons"],l),e}function pi(o,n){const e={},t=s(n,["name"]);t!=null&&r(e,["name"],t);const i=s(n,["metadata"]);i!=null&&r(e,["metadata"],i);const l=s(n,["done"]);l!=null&&r(e,["done"],l);const u=s(n,["error"]);u!=null&&r(e,["error"],u);const a=s(n,["response"]);a!=null&&r(e,["response"],a);const c=s(n,["response","generateVideoResponse"]);return c!=null&&r(e,["result"],hi(o,c)),e}function mi(o,n){const e={},t=s(n,["gcsUri"]);t!=null&&r(e,["uri"],t);const i=s(n,["bytesBase64Encoded"]);i!=null&&r(e,["videoBytes"],V(o,i));const l=s(n,["mimeType"]);return l!=null&&r(e,["mimeType"],l),e}function gi(o,n){const e={},t=s(n,["_self"]);return t!=null&&r(e,["video"],mi(o,t)),e}function yi(o,n){const e={},t=s(n,["videos"]);t!=null&&(Array.isArray(t)?r(e,["generatedVideos"],t.map(u=>gi(o,u))):r(e,["generatedVideos"],t));const i=s(n,["raiMediaFilteredCount"]);i!=null&&r(e,["raiMediaFilteredCount"],i);const l=s(n,["raiMediaFilteredReasons"]);return l!=null&&r(e,["raiMediaFilteredReasons"],l),e}function Be(o,n){const e={},t=s(n,["name"]);t!=null&&r(e,["name"],t);const i=s(n,["metadata"]);i!=null&&r(e,["metadata"],i);const l=s(n,["done"]);l!=null&&r(e,["done"],l);const u=s(n,["error"]);u!=null&&r(e,["error"],u);const a=s(n,["response"]);a!=null&&r(e,["response"],a);const c=s(n,["response"]);return c!=null&&r(e,["result"],yi(o,c)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Ci extends W{constructor(n){super(),this.apiClient=n}async get(n){const e=n.operation,t=n.config;if(e.name===void 0||e.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const l=e.name.split("/operations/")[0];var i=void 0;return t&&"httpOptions"in t&&(i=t.httpOptions),this.fetchPredictVideosOperationInternal({operationName:e.name,resourceName:l,config:{httpOptions:i}})}else return this.getVideosOperationInternal({operationName:e.name,config:t})}async getVideosOperationInternal(n){var e,t;let i,l="",u={};if(this.apiClient.isVertexAI()){const a=ui(this.apiClient,n);return l=E("{operationName}",a._url),u=a._query,delete a.config,delete a._url,delete a._query,i=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(e=n.config)===null||e===void 0?void 0:e.httpOptions}).then(c=>c.json()),i.then(c=>Be(this.apiClient,c))}else{const a=ai(this.apiClient,n);return l=E("{operationName}",a._url),u=a._query,delete a.config,delete a._url,delete a._query,i=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions}).then(c=>c.json()),i.then(c=>pi(this.apiClient,c))}}async fetchPredictVideosOperationInternal(n){var e;let t,i="",l={};if(this.apiClient.isVertexAI()){const u=ci(this.apiClient,n);return i=E("{resourceName}:fetchPredictOperation",u._url),l=u._query,delete u.config,delete u._url,delete u._query,t=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(e=n.config)===null||e===void 0?void 0:e.httpOptions}).then(a=>a.json()),t.then(a=>Be(this.apiClient,a))}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Ti="Content-Type",Ei="User-Agent",vi="x-goog-api-client",_i="0.7.0",Ii=`google-genai-sdk/${_i}`,Ai="v1beta1",Mi="v1beta",He=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class Si extends Error{constructor(n,e){e?super(n,{cause:e}):super(n,{cause:new Error().stack}),this.message=n,this.name="ClientError"}}class Ke extends Error{constructor(n,e){e?super(n,{cause:e}):super(n,{cause:new Error().stack}),this.message=n,this.name="ServerError"}}class Pi{constructor(n){var e,t;this.clientOptions=Object.assign(Object.assign({},n),{project:n.project,location:n.location,apiKey:n.apiKey,vertexai:n.vertexai});const i={};this.clientOptions.vertexai?(i.apiVersion=(e=this.clientOptions.apiVersion)!==null&&e!==void 0?e:Ai,this.getProject()||this.getLocation()?(i.baseUrl=`https://${this.clientOptions.location}-aiplatform.googleapis.com/`,this.clientOptions.apiKey=void 0):(i.baseUrl="https://aiplatform.googleapis.com/",this.clientOptions.project=void 0,this.clientOptions.location=void 0)):(i.apiVersion=(t=this.clientOptions.apiVersion)!==null&&t!==void 0?t:Mi,i.baseUrl="https://generativelanguage.googleapis.com/"),i.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=i,n.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(i,n.httpOptions))}isVertexAI(){var n;return(n=this.clientOptions.vertexai)!==null&&n!==void 0?n:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(n){if(!n||n.baseUrl===void 0||n.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const t=[n.baseUrl.endsWith("/")?n.baseUrl.slice(0,-1):n.baseUrl];return n.apiVersion&&n.apiVersion!==""&&t.push(n.apiVersion),t.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const n=this.getBaseUrl(),e=new URL(n);return e.protocol="wss",e.toString()}setBaseUrl(n){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=n;else throw new Error("HTTP options are not correctly set.")}constructUrl(n,e){const t=[this.getRequestUrlInternal(e)];return this.clientOptions.vertexai&&!this.clientOptions.apiKey&&!n.startsWith("projects/")&&t.push(this.getBaseResourcePath()),n!==""&&t.push(n),new URL(`${t.join("/")}`)}async request(n){let e=this.clientOptions.httpOptions;n.httpOptions&&(e=this.patchHttpOptions(this.clientOptions.httpOptions,n.httpOptions));const t=this.constructUrl(n.path,e);if(n.queryParams)for(const[l,u]of Object.entries(n.queryParams))t.searchParams.append(l,String(u));let i={};if(n.httpMethod==="GET"){if(n.body&&n.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else i.body=n.body;return i=await this.includeExtraHttpOptionsToRequestInit(i,e),this.unaryApiCall(t,i,n.httpMethod)}patchHttpOptions(n,e){const t=JSON.parse(JSON.stringify(n));for(const[i,l]of Object.entries(e))typeof l=="object"?t[i]=Object.assign(Object.assign({},t[i]),l):l!==void 0&&(t[i]=l);return t}async requestStream(n){let e=this.clientOptions.httpOptions;n.httpOptions&&(e=this.patchHttpOptions(this.clientOptions.httpOptions,n.httpOptions));const t=this.constructUrl(n.path,e);(!t.searchParams.has("alt")||t.searchParams.get("alt")!=="sse")&&t.searchParams.set("alt","sse");let i={};return i.body=n.body,i=await this.includeExtraHttpOptionsToRequestInit(i,e),this.streamApiCall(t,i,n.httpMethod)}async includeExtraHttpOptionsToRequestInit(n,e){if(e&&e.timeout&&e.timeout>0){const t=new AbortController,i=t.signal;setTimeout(()=>t.abort(),e.timeout),n.signal=i}return n.headers=await this.getHeadersInternal(e),n}async unaryApiCall(n,e,t){return this.apiCall(n.toString(),Object.assign(Object.assign({},e),{method:t})).then(async i=>(await Oe(i),new en(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}async streamApiCall(n,e,t){return this.apiCall(n.toString(),Object.assign(Object.assign({},e),{method:t})).then(async i=>(await Oe(i),this.processStreamResponse(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}processStreamResponse(n){var e;return J(this,arguments,function*(){const i=(e=n==null?void 0:n.body)===null||e===void 0?void 0:e.getReader(),l=new TextDecoder("utf-8");if(!i)throw new Error("Response body is empty");try{let u="";for(;;){const{done:a,value:c}=yield A(i.read());if(a){if(u.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const f=l.decode(c);u+=f;let d=u.match(He);for(;d;){const h=d[1];try{const g=JSON.parse(h);yield yield A(g),u=u.slice(d[0].length),d=u.match(He)}catch(g){throw new Error(`exception parsing stream chunk ${h}. ${g}`)}}}}finally{i.releaseLock()}})}async apiCall(n,e){return fetch(n,e).catch(t=>{throw new Error(`exception ${t} sending request`)})}getDefaultHeaders(){const n={},e=Ii+" "+this.clientOptions.userAgentExtra;return n[Ei]=e,n[vi]=e,n[Ti]="application/json",n}async getHeadersInternal(n){const e=new Headers;if(n&&n.headers)for(const[t,i]of Object.entries(n.headers))e.append(t,i);return await this.clientOptions.auth.addAuthHeaders(e),e}async uploadFile(n,e){var t;const i={};e!=null&&(i.mimeType=e.mimeType,i.name=e.name,i.displayName=e.displayName),i.name&&!i.name.startsWith("files/")&&(i.name=`files/${i.name}`);const l=this.clientOptions.uploader,u=await l.stat(n);i.sizeBytes=String(u.size);const a=(t=e==null?void 0:e.mimeType)!==null&&t!==void 0?t:u.type;if(a===void 0||a==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");i.mimeType=a;const c=await this.fetchUploadUrl(i,e);return l.upload(n,c,this)}async fetchUploadUrl(n,e){var t;let i={};e!=null&&e.httpOptions?i=e.httpOptions:i={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${n.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${n.mimeType}`}};const l={file:n},u=await this.request({path:E("upload/v1beta/files",l._url),body:JSON.stringify(l),httpMethod:"POST",httpOptions:i});if(!u||!(u!=null&&u.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const a=(t=u==null?void 0:u.headers)===null||t===void 0?void 0:t["x-goog-upload-url"];if(a===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return a}}async function Oe(o){var n;if(o===void 0)throw new Ke("response is undefined");if(!o.ok){const e=o.status,t=o.statusText;let i;!((n=o.headers.get("content-type"))===null||n===void 0)&&n.includes("application/json")?i=await o.json():i={error:{message:"exception parsing response",code:o.status,status:o.statusText}};const l=`got status: ${e} ${t}. ${JSON.stringify(i)}`;throw e>=400&&e<500?new Si(l):e>=500&&e<600?new Ke(l):new Error(l)}}const Ri=1024*1024*8;async function xi(o,n,e){var t,i;let l=0,u=0,a=new en(new Response),c="upload";for(l=o.size;u<l;){const d=Math.min(Ri,l-u),h=o.slice(u,u+d);if(u+d>=l&&(c+=", finalize"),a=await e.request({path:"",body:h,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:n,headers:{"X-Goog-Upload-Command":c,"X-Goog-Upload-Offset":String(u),"Content-Length":String(d)}}}),u+=d,((t=a==null?void 0:a.headers)===null||t===void 0?void 0:t["x-goog-upload-status"])!=="active")break;if(l<=u)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const f=await(a==null?void 0:a.json());if(((i=a==null?void 0:a.headers)===null||i===void 0?void 0:i["x-goog-upload-status"])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return f.file}async function wi(o){return{size:o.size,type:o.type}}class Ni{async upload(n,e,t){if(typeof n=="string")throw new Error("File path is not supported in browser uploader.");return await xi(n,e,t)}async stat(n){if(typeof n=="string")throw new Error("File path is not supported in browser uploader.");return await wi(n)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Di{create(n,e,t){return new Vi(n,e,t)}}class Vi{constructor(n,e,t){this.url=n,this.headers=e,this.callbacks=t}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(n){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(n)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Ye="x-goog-api-key";class Fi{constructor(n){this.apiKey=n}async addAuthHeaders(n){n.get(Ye)===null&&n.append(Ye,this.apiKey)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Li="gl-node/";class Ui{constructor(n){var e;if(n.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(n.project||n.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(e=n.vertexai)!==null&&e!==void 0?e:!1,this.apiKey=n.apiKey,this.apiVersion=n.apiVersion;const t=new Fi(this.apiKey);this.apiClient=new Pi({auth:t,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:n.httpOptions,userAgentExtra:Li+"web",uploader:new Ni}),this.models=new li(this.apiClient),this.live=new ti(this.apiClient,t,new Di),this.chats=new ot(this.models,this.apiClient),this.caches=new jn(this.apiClient),this.files=new gt(this.apiClient),this.operations=new Ci(this.apiClient)}}/**
 * @license
 * SPDX-License-Identifier: Apache-2.0
*/const z=document.getElementById("script-content");if(z){const o=`
        <h2>Kịch Bản Dự Án: Giải Cứu Khu Rừng Phép Thuật Mini World</h2>

        <p><strong>Chủ đề:</strong> Phiêu lưu, giải đố, xây dựng và sáng tạo.</p>

        <h3>📖 Cốt truyện:</h3>
        <p>Khu Rừng Phép Thuật Mini World, nơi sinh sống của vô vàn sinh vật kỳ diệu và những loài cây rực rỡ, đang gặp nguy hiểm! Một thế lực bóng tối bí ẩn đã len lỏi vào khu rừng, đánh cắp đi những <strong>Viên Đá Năng Lượng</strong> quý giá. Thiếu đi sức mạnh của các viên đá, cây cối bắt đầu héo úa, các dòng suối ngừng chảy, và cả khu rừng chìm trong u buồn.
        Các bạn nhỏ ơi, hãy hóa thân thành những nhà thám hiểm dũng cảm, khoác lên mình bộ trang phục sáng tạo nhất và bắt đầu hành trình giải cứu Khu Rừng Phép Thuật!</p>

        <h3>🎯 Nhiệm vụ của bạn:</h3>
        <p>Nhiệm vụ chính của các bạn là tìm lại toàn bộ các Viên Đá Năng Lượng bị đánh cắp, khôi phục lại sự sống cho khu rừng và khám phá ra bí mật đằng sau thế lực bóng tối. Để làm được điều đó, các bạn sẽ cần:</p>
        <ol>
            <li><strong>Chuẩn bị hành trang - Xây dựng Trại Căn Cứ An Toàn:</strong>
                <ul>
                    <li>Xây dựng một ngôi nhà vững chãi bằng các khối cơ bản, nơi bạn có thể nghỉ ngơi và lên kế hoạch. (Tham khảo <strong>Bài 2: Xây Ngôi Nhà Đầu Tiên</strong>)</li>
                    <li>Tạo một khu vườn xinh xắn trồng các loại cây hữu ích, có thể cả một trang trại nhỏ. (Tham khảo <strong>Bài 3: Làm Vườn Xinh</strong>, <strong>Bài 7: Trang Trại Tự Động</strong>)</li>
                    <li>Trang trí trại căn cứ thật độc đáo theo phong cách của riêng bạn! (Tham khảo <strong>Bài 4: Trang Trí Ngôi Nhà</strong>)</li>
                </ul>
            </li>
            <li><strong>Khám phá Khu Rừng Phép Thuật - Tìm kiếm các Viên Đá Năng Lượng:</strong>
                <ul>
                    <li>Khu rừng rất rộng lớn! Hãy dùng <strong>Máy Địa Hình</strong> để nặn đồi, đào hồ, tạo ra những cảnh quan độc đáo như hang động bí mật, thác nước kỳ ảo, nơi các Viên Đá có thể được cất giấu. (Tham khảo <strong>Bài 5: Nặn Đất, Đào Hồ</strong>, <strong>Bài 6: Thêm Cây Xanh, Tạo Nguồn Nước</strong>)</li>
                    <li>Mỗi Viên Đá Năng Lượng sẽ được ẩn giấu trong một khu vực khác nhau, đòi hỏi bạn phải vượt qua thử thách hoặc giải được câu đố.</li>
                </ul>
            </li>
            <li><strong>Vượt qua thử thách - Sử dụng Logic và Sức mạnh Sáng tạo:</strong>
                <p>Mỗi Viên Đá Năng Lượng được bảo vệ bởi một thử thách. Hãy vận dụng kiến thức đã học để vượt qua!</p>
                <ul>
                    <li><strong>Thử thách 1: Mê Cung Kỳ Bí.</strong> Thiết kế một mê cung đầy cạm bẫy hoặc bí ẩn. Viên Đá Năng Lượng nằm ở cuối mê cung. (Tham khảo <strong>Bài 14: Xây Mê Cung Thử Thách</strong>)
                        <ul>
                            <li>Sử dụng <strong>Trigger</strong> để tạo đèn tự động bật sáng khi bạn đi vào một khu vực tối (<strong>Bài 11: Phép Thuật Trigger: Đi Vào Là Sáng Đèn!</strong>).</li>
                            <li>Dùng <strong>Trigger</strong> để mở những cánh cửa bí mật khi bạn đặt đúng vật phẩm hoặc đứng vào vị trí quy định (<strong>Bài 13: Trigger Mở Cửa Tự Động</strong>).</li>
                        </ul>
                    </li>
                    <li><strong>Thử thách 2: Bí Mật Mạch Điện.</strong> Tạo ra một hệ thống mạch điện phức tạp. Bạn cần bật các công tắc theo đúng thứ tự để dòng điện thắp sáng con đường dẫn đến Viên Đá hoặc kích hoạt một cơ chế bí mật. (Tham khảo <strong>Bài 9: Bí Mật Mạch Điện: Bật Tắt Đèn</strong>).</li>
                    <li><strong>Thử thách 3: Vượt Chướng Ngại Vật Bằng Xe Mỏ.</strong> Thiết kế một đoạn đường ray xe mỏ đầy thử thách, vượt qua dung nham hoặc vực sâu để lấy Viên Đá. (Tham khảo <strong>Bài 8: Chế Tạo Đường Ray và Xe Mỏ</strong>).</li>
                    <li><em>Gợi ý:</em> Các bạn có thể sáng tạo thêm các thử thách khác sử dụng kiến thức về <strong>Trigger</strong>, <strong>Luật Chơi</strong> (<strong>Bài 10</strong>), và các cơ chế tự động!</li>
                </ul>
            </li>
            <li><strong>Gặp gỡ Cư Dân Rừng Xanh - Tìm kiếm sự giúp đỡ:</strong>
                <ul>
                    <li>Tạo ra các <strong>NPC (Người Bạn Đồng Hành)</strong> là những sinh vật của rừng (ví dụ: Thần Rừng, cáo thông thái, sóc nhanh nhẹn). Họ có thể đưa ra gợi ý, giao nhiệm vụ phụ, hoặc kể cho bạn nghe những bí mật của khu rừng. (Tham khảo <strong>Bài 17: Tạo Người Bạn Đồng Hành NPC</strong>)</li>
                    <li>Sử dụng <strong>Trigger</strong> để NPC gửi thông báo hoặc hội thoại khi bạn đến gần. (Tham khảo <strong>Bài 16: Trigger Gửi Thông Báo</strong>)</li>
                </ul>
            </li>
            <li><strong>Phục Hồi Khu Rừng - Hoàn thành sứ mệnh:</strong>
                <ul>
                    <li>Sau khi thu thập đủ các Viên Đá Năng Lượng, hãy tìm đến "Bệ Đá Cổ" linh thiêng và đặt các viên đá vào đúng vị trí.</li>
                    <li>Khi tất cả các viên đá được đặt đúng, khu rừng sẽ được phục hồi! Hãy tạo hiệu ứng đặc biệt (ví dụ: cây cối bừng sáng, hoa nở rộ, âm nhạc vui tươi) để đánh dấu khoảnh khắc này.</li>
                </ul>
            </li>
        </ol>

        <h3>🛠️ Công cụ Mini World hỗ trợ:</h3>
        <ul>
            <li><strong>Khối Xây Dựng:</strong> Vô vàn loại khối để bạn xây nhà, tạo cảnh quan.</li>
            <li><strong>Máy Địa Hình:</strong> Thay đổi địa hình, tạo núi, sông, hồ theo ý muốn.</li>
            <li><strong>Trigger & Mạch Điện:</strong> Tạo ra các cơ chế tự động, logic game, hiệu ứng đặc biệt.</li>
            <li><strong>UI Editor:</strong> Thiết kế bảng hướng dẫn, thông báo, menu cho trò chơi của bạn. (Tham khảo <strong>Bài 15: Tạo Bảng Hướng Dẫn Với UI Editor</strong>)</li>
        </ul>

        <h3>🏆 Yêu cầu sản phẩm cuối cùng (Dự án của bạn):</h3>
        <ul>
            <li>Một thế giới Mini World hoàn chỉnh với câu chuyện "Giải Cứu Khu Rừng Phép Thuật" được cá nhân hóa.</li>
            <li>Có ít nhất 3 thử thách sử dụng Trigger hoặc mạch điện để tìm Viên Đá Năng Lượng.</li>
            <li>Có ít nhất 1 NPC đưa ra gợi ý hoặc nhiệm vụ.</li>
            <li>Xây dựng được một Trại Căn Cứ cá nhân.</li>
            <li>Thế giới có thể chơi được từ đầu đến cuối, dẫn đến việc phục hồi khu rừng.</li>
            <li>Thể hiện sự sáng tạo và dấu ấn cá nhân của bạn!</li>
            <li>Đừng quên chuẩn bị bài <strong>Giới Thiệu Sáng Tạo Của Em</strong> (<strong>Bài 20</strong>) để chia sẻ thành quả của mình nhé!</li>
        </ul>

        <h3>💡 Gợi ý thêm (Thử thách nâng cao):</h3>
        <ul>
            <li>Tạo thêm một mini-game trong khu rừng, ví dụ như <strong>Game Săn Kho Báu</strong> (<strong>Bài 18</strong>) với các hòm báu ẩn chứa vật phẩm hỗ trợ.</li>
            <li>Thiết kế trang phục hoặc công cụ đặc biệt cho nhân vật của bạn.</li>
            <li>Viết thêm các đoạn hội thoại thú vị và hài hước cho NPC.</li>
            <li>Sử dụng luật chơi (<strong>Bài 10</strong>) để tạo ra các quy tắc riêng cho thế giới của bạn.</li>
        </ul>
        <p>Chúc các bạn có những giờ phút thiết kế và lập trình thật vui vẻ, sáng tạo ra những Khu Rừng Phép Thuật tuyệt vời nhất!</p>
    `;z.innerHTML=o;const n=document.createElement("div");n.id="gemini-creative-tip-container";const e=document.createElement("h3");e.textContent="✨ Gợi Ý Sáng Tạo Từ Gemini ✨",n.appendChild(e);const t=document.createElement("p");t.id="gemini-tip-text",t.textContent="Đang tải gợi ý từ Gemini...",n.appendChild(t),z.appendChild(n);async function i(){try{const u=await new Ui({apiKey:"AIzaSyA5rY69tMEsEw0f8EMLZM2nMOEfJ24DrNs"}).models.generateContent({model:"gemini-2.5-flash-preview-04-17",contents:'Hãy đưa ra một lời khuyên sáng tạo thật ngắn gọn (tối đa 2 câu) bằng tiếng Việt cho một bạn nhỏ đang làm dự án game trong Mini World có tên "Giải Cứu Khu Rừng Phép Thuật". Lời khuyên nên khuyến khích sự độc đáo và vui vẻ.'});t.textContent=u.text}catch(l){console.error("Lỗi khi lấy gợi ý từ Gemini:",l),t.textContent="Không thể tải gợi ý sáng tạo lúc này. Đừng lo, hãy thử tự mình nghĩ ra một ý tưởng thật độc đáo và vui nhé!",t.style.color="red"}}i()}else console.error("Không tìm thấy phần tử #script-content trong DOM."),document.body.innerHTML='<p style="color: red; text-align: center; margin-top: 20px;">Lỗi: Không thể tải nội dung kịch bản. Vui lòng kiểm tra console.</p>';
